<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Ëñ©Ë´æÁì¶Áæ©ÂºèÂªöÊàø - SANOVA KITCHEN</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    :root {
      --brand-main: #B91C1C;
      --brand-dark: #7F1D1D;
      --bg-color: #f8fafc;
    }
    body { 
      font-family: -apple-system, BlinkMacSystemFont, "Microsoft JhengHei", "PingFang TC", sans-serif; 
      background-color: var(--bg-color); 
      margin: 0; padding: 0; overflow-x: hidden;
      -webkit-tap-highlight-color: transparent;
    }
    .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    
    .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); }
    .no-scrollbar::-webkit-scrollbar { display: none; }
    
    #loading-overlay {
      position: fixed; inset: 0; background: #000; display: flex; flex-direction: column;
      align-items: center; justify-content: center; z-index: 9999;
      transition: opacity 0.6s ease;
    }
    #loading-img {
      position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover;
      opacity: 0.55; filter: saturate(1.2);
    }
    .loading-content { position: relative; z-index: 10; text-align: center; color: white; }
    .spinner-red {
      width: 55px; height: 55px; border: 4px solid rgba(255,255,255,0.1); border-top-color: var(--brand-main);
      border-radius: 50%; animation: spin 0.8s linear infinite; margin: 0 auto 25px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    .input-field {
      @apply w-full p-4 border border-gray-200 rounded-2xl bg-gray-50 focus:bg-white focus:ring-2 focus:ring-[#B91C1C] focus:border-transparent outline-none transition-all text-sm;
    }
    .btn-primary {
      @apply w-full py-4 bg-red-700 text-white rounded-2xl font-black shadow-lg shadow-red-900/20 active:scale-95 transition-all disabled:opacity-50;
    }
    .chat-bubble-ai { @apply bg-gray-100 text-slate-800 p-4 rounded-2xl rounded-tl-none text-sm max-w-[85%]; }
    .chat-bubble-user { @apply bg-red-700 text-white p-4 rounded-2xl rounded-tr-none text-sm max-w-[85%] self-end; }
  </style>
</head>
<body>
  <div id="loading-overlay">
    <img id="loading-img" src="https://i.ibb.co/qLFg7gSk/Gemini-Generated-Image-cmj4yzcmj4yzcmj4.png" />
    <div class="loading-content">
      <div class="spinner-red"></div>
      <h2 style="font-weight: 900; letter-spacing: 6px; font-size: 26px;">SANOVA</h2>
      <p style="font-size: 11px; opacity: 0.8; letter-spacing: 4px; margin-top: 6px; font-weight: bold;">ITALIAN KITCHEN</p>
    </div>
  </div>

  <div id="root"></div>

  <script>
    // Polyfill process for browser environment to prevent crash
    window.process = window.process || { env: { API_KEY: '' } };
    window.onerror = function() {
      // Ensure loading screen goes away even if there is an error
      const el = document.getElementById('loading-overlay');
      if(el) el.style.display = 'none';
    };
  </script>

  <script type="module">
    import React, { useState, useEffect, useMemo, useRef } from 'https://esm.sh/react@18.2.0';
    import ReactDOM from 'https://esm.sh/react-dom@18.2.0/client';
    import { GoogleGenAI } from "https://esm.sh/@google/genai";

    const LIFF_ID = "2008861231-EA0Hpl68"; 
    const RESTAURANT_NAME = "Ëñ©Ë´æÁì¶Áæ©ÂºèÂªöÊàø"; 
    const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxHOJOzIGqCnW-ttjB0_OeJ6eIz3iqF3dnYSwGeK4L2vRi6dEuWZ-i_DoM5pHjz9u7PlA/exec";
    const ADMIN_PHONES = ['0937942582', '0978375273', '0978375592'];

    const runGAS = async (action, params = {}) => {
      try {
        const response = await fetch(GOOGLE_SCRIPT_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'text/plain;charset=utf-8' },
          body: JSON.stringify({ action, ...params })
        });
        return await response.json();
      } catch (err) {
        return { status: 'error', message: 'ÈÄ£Á∑öË∂ÖÊôÇÔºåË´ãÊ™¢Êü•Á∂≤Ë∑Ø' };
      }
    };

    const Icon = ({ name, className }) => {
      const paths = {
        home: "M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6",
        menu: "M4 6h16M4 12h16M4 18h16",
        calendar: "M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2-2H5a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z",
        user: "M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z",
        back: "M10 19l-7-7m0 0l7-7m-7 7h18",
        info: "M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",
        phone: "M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z",
        chart: "M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z",
        gift: "M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7",
        sparkles: "M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-7.714 2.143L11 21l-2.286-6.857L1 12l7.714-2.143L11 3z",
        question: "M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",
        trash: "M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
      };
      return React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className, fill: "none", viewBox: "0 0 24 24", stroke: "currentColor", strokeWidth: "2" },
        React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: paths[name] || "" })
      );
    };

    const ChefChat = ({ onClose }) => {
      const [messages, setMessages] = useState([{ role: 'ai', text: 'CiaoÔºÅÊàëÊòØ SANOVA ‰∏ªÂªö„ÄÇÊÉ≥Áü•ÈÅì‰ªäÂ§©ÁöÑÊé®Ëñ¶ËèúËâ≤ÔºåÊàñÈúÄË¶ÅÈªûÈ§êÂª∫Ë≠∞ÂóéÔºü' }]);
      const [input, setInput] = useState('');
      const [isTyping, setIsTyping] = useState(false);
      const scrollRef = useRef(null);

      useEffect(() => { scrollRef.current?.scrollIntoView({ behavior: 'smooth' }); }, [messages]);

      const handleSend = async () => {
        if (!input.trim() || isTyping) return;
        const userMsg = input;
        setInput('');
        setMessages(prev => [...prev, { role: 'user', text: userMsg }]);
        setIsTyping(true);

        try {
          const ai = new GoogleGenAI({ apiKey: process.env.API_KEY || 'AI_KEY_NOT_SET' });
          const response = await ai.models.generateContent({
            model: 'gemini-3-flash-preview',
            contents: `‰Ω†ÊòØËñ©Ë´æÁì¶Áæ©ÂºèÂªöÊàø (SANOVA KITCHEN) ÁöÑÁÜ±ÊÉÖÁæ©Â§ßÂà©‰∏ªÂªö„ÄÇË´ãÁî®Á∞°Áü≠„ÄÅÊ¥ªÊΩë„ÄÅÂ∞àÊ•≠ÁöÑË™ûÊ∞£ÂõûÁ≠î„ÄÇÈ°ßÂÆ¢ÂïèÔºö${userMsg}`,
          });
          setMessages(prev => [...prev, { role: 'ai', text: response.text || '‰∏ªÂªöÊ≠£Âú®ÂøôÁ¢å‰∏≠ÔºåË´ãÁ®çÂæåÂÜçË©¶„ÄÇ' }]);
        } catch (e) {
          console.error(e);
          setMessages(prev => [...prev, { role: 'ai', text: 'ÁõÆÂâçÁ∑öË∑ØÁπÅÂøôÔºåË´ãÁ®çÂæåÂÜçË©¶„ÄÇ(Ë´ãÁ¢∫Ë™çAPI KeyÈÖçÁΩÆ)' }]);
        } finally {
          setIsTyping(false);
        }
      };

      return React.createElement("div", { className: "fixed inset-0 z-[100] bg-white flex flex-col animate-fade-in" },
        React.createElement("div", { className: "bg-red-700 text-white p-6 flex justify-between items-center" },
          React.createElement("div", { className: "flex items-center gap-3" },
            React.createElement("div", { className: "w-10 h-10 bg-white/20 rounded-full flex items-center justify-center font-black" }, "üë®‚Äçüç≥"),
            React.createElement("div", null, React.createElement("h3", { className: "font-black" }, "Áæ©Â§ßÂà©‰∏ªÂªöËÅäËÅä"), React.createElement("p", { className: "text-[10px] opacity-70" }, "AI Êô∫ÊÖßÊé®Ëñ¶"))
          ),
          React.createElement("button", { onClick: onClose, className: "text-xs font-bold" }, "ÈóúÈñâ")
        ),
        React.createElement("div", { className: "flex-1 overflow-y-auto p-6 space-y-4" },
          messages.map((m, i) => React.createElement("div", { key: i, className: `flex flex-col ${m.role === 'user' ? 'items-end' : 'items-start'}` },
            React.createElement("div", { className: m.role === 'user' ? 'chat-bubble-user' : 'chat-bubble-ai' }, m.text)
          )),
          isTyping && React.createElement("div", { className: "chat-bubble-ai animate-pulse" }, "‰∏ªÂªöÊÄùËÄÉ‰∏≠..."),
          React.createElement("div", { ref: scrollRef })
        ),
        React.createElement("div", { className: "p-6 border-t flex gap-2" },
          React.createElement("input", { className: "input-field flex-1", placeholder: "Ëº∏ÂÖ•ÂïèÈ°å...", value: input, onChange: e => setInput(e.target.value), onKeyPress: e => e.key === 'Enter' && handleSend() }),
          React.createElement("button", { onClick: handleSend, className: "bg-red-700 text-white px-6 rounded-2xl font-black" }, "ÈÄÅÂá∫")
        )
      );
    };

    const BookingView = ({ profile, onComplete, cart, onClearCart }) => {
      const [form, setForm] = useState({ 
        date: new Date().toISOString().split('T')[0], 
        time: "11:30", adults: 2, children: 0, highChairs: 0, vegetarian: false,
        name: profile?.displayName || "", phone: "", notes: "" 
      });
      const [loading, setLoading] = useState(false);
      const times = ["11:00", "11:30", "12:00", "12:30", "13:00", "17:00", "17:30", "18:00", "18:30", "19:00", "19:30"];

      const handleBooking = async () => {
        if (!form.phone || form.phone.length < 9) return Swal.fire('Ë´ãËº∏ÂÖ•ÊâãÊ©ü', '', 'warning');
        setLoading(true);
        // ÁµÑÂêàË≥ºÁâ©ËªäÂÖßÂÆπÁÇ∫Â≠ó‰∏≤
        const preOrderStr = cart.map(i => `${i.Áî¢ÂìÅÂêçÁ®±} x${i.qty}`).join(', ');
        const res = await runGAS('booking', { ...form, lineUserId: profile?.userId, preOrder: preOrderStr });
        setLoading(false);
        if (res.status === 'success') {
          if (cart.length > 0) onClearCart();
          await Swal.fire({ title: 'È†êÁ¥ÑÊàêÂäüÔºÅ', text: `Ë®Ç‰Ωç‰ª£ËôüÔºö${res.bookingCode}`, icon: 'success', confirmButtonColor: '#B91C1C' });
          onComplete();
        } else {
          Swal.fire('Á≥ªÁµ±ÂøôÁ¢å', res.message, 'error');
        }
      };

      return React.createElement("div", { className: "p-6 space-y-6 animate-fade-in pb-32" },
        React.createElement("h3", { className: "font-black text-xl" }, "Á∑ö‰∏äÈ†êÁ¥Ñ"),
        // È°ØÁ§∫È†êÈªûÊ∏ÖÂñÆ
        cart.length > 0 && React.createElement("div", { className: "bg-amber-50 p-4 rounded-2xl border border-amber-100" },
           React.createElement("h4", { className: "font-black text-amber-800 text-sm mb-2" }, "üõí Â∑≤È†êÈªûÈ§êÈªû"),
           cart.map((item, idx) => React.createElement("div", { key: idx, className: "flex justify-between text-xs text-amber-900 mb-1" },
             React.createElement("span", null, item.Áî¢ÂìÅÂêçÁ®±),
             React.createElement("span", { className: "font-bold" }, `x${item.qty}`)
           ))
        ),
        React.createElement("div", { className: "space-y-5" },
          React.createElement("input", { type: "date", className: "input-field", value: form.date, onChange: e => setForm({...form, date: e.target.value}) }),
          React.createElement("div", { className: "grid grid-cols-4 gap-2" }, times.map(t => React.createElement("button", { key: t, onClick: () => setForm({...form, time: t}), className: `py-2 rounded-xl text-xs font-black transition-all ${form.time === t ? 'bg-red-700 text-white shadow-lg' : 'bg-gray-100 text-gray-400'}` }, t))),
          React.createElement("div", { className: "grid grid-cols-2 gap-4" },
            React.createElement("div", null, React.createElement("label", { className: "text-xs font-black text-gray-400 mb-1 block" }, "Â§ß‰∫∫"), React.createElement("input", { type: "number", className: "input-field", value: form.adults, onChange: e => setForm({...form, adults: e.target.value}) })),
            React.createElement("div", null, React.createElement("label", { className: "text-xs font-black text-gray-400 mb-1 block" }, "Â∞èÂ≠©"), React.createElement("input", { type: "number", className: "input-field", value: form.children, onChange: e => setForm({...form, children: e.target.value}) }))
          ),
          React.createElement("input", { type: "tel", className: "input-field", placeholder: "ËÅØÁµ°ÊâãÊ©ü (ÂøÖÂ°´)", value: form.phone, onChange: e => setForm({...form, phone: e.target.value}) }),
          React.createElement("textarea", { className: "input-field h-24", placeholder: "ÂÇôË®ª (ÂÖíÁ´•Ê§Ö„ÄÅÁ¥†È£ü„ÄÅÊÖ∂Áîü...)", value: form.notes, onChange: e => setForm({...form, notes: e.target.value}) })
        ),
        React.createElement("button", { onClick: handleBooking, disabled: loading, className: "btn-primary" }, loading ? "ÈÄÅÂá∫Ë®ÇÂñÆ‰∏≠..." : "Á¢∫Ë™çÈ†êÁ¥Ñ")
      );
    };

    const MenuView = ({ menu, addToCart, cart }) => {
      const cats = useMemo(() => [...new Set(menu.map(i => i.È°ûÂà•))], [menu]);
      const [activeCat, setActiveCat] = useState(cats[0] || "");
      
      useEffect(() => { if (cats.length > 0 && !activeCat) setActiveCat(cats[0]); }, [cats]);

      return React.createElement("div", { className: "animate-fade-in pb-32" },
        React.createElement("div", { className: "flex overflow-x-auto p-4 gap-2 no-scrollbar sticky top-[80px] bg-white/95 backdrop-blur z-20 border-b border-gray-100" },
          cats.map(c => React.createElement("button", { key: c, onClick: () => setActiveCat(c), className: `px-6 py-2 rounded-full text-xs font-black whitespace-nowrap transition-all ${activeCat === c ? 'bg-red-700 text-white shadow-md' : 'bg-gray-100 text-gray-400'}` }, c))
        ),
        React.createElement("div", { className: "p-4 space-y-4" },
          menu.filter(i => i.È°ûÂà• === activeCat).map((item, idx) => {
            const inCart = cart.find(c => c.Áî¢ÂìÅÂêçÁ®± === item.Áî¢ÂìÅÂêçÁ®±);
            return React.createElement("div", { key: idx, className: "flex gap-4 bg-white p-3 rounded-2xl border border-gray-50 shadow-sm" },
              React.createElement("img", { src: item.ÂúñÁâáÁ∂≤ÂùÄ, className: "w-24 h-24 object-cover rounded-xl flex-shrink-0" }),
              React.createElement("div", { className: "flex-1 py-1 flex flex-col justify-between" },
                React.createElement("div", null, 
                  React.createElement("h4", { className: "font-black text-slate-800 text-sm" }, item.Áî¢ÂìÅÂêçÁ®±),
                  React.createElement("p", { className: "text-[10px] text-gray-400 mt-1 line-clamp-2" }, item.Ë™™Êòé)
                ),
                React.createElement("div", { className: "flex justify-between items-center mt-2" },
                  React.createElement("p", { className: "text-red-700 font-black text-sm" }, `$${item.Áî¢ÂìÅÂÉπÊ†º}`),
                  React.createElement("button", { onClick: () => addToCart(item), className: `text-[10px] font-black px-3 py-1.5 rounded-full transition-all ${inCart ? 'bg-green-100 text-green-700' : 'bg-red-50 text-red-700'}` }, 
                    inCart ? `Â∑≤ÈÅ∏ ${inCart.qty}` : "+ Âä†ÂÖ•È†êÈªû"
                  )
                )
              )
            );
          })
        )
      );
    };

    const AdminDashboard = ({ profile, onBack }) => {
        const [bookings, setBookings] = useState([]);
        const [loading, setLoading] = useState(true);
        useEffect(() => {
          runGAS('getAdminData', { lineUserId: profile?.userId }).then(res => {
            if (res.status === 'success') setBookings(res.bookings || []);
            setLoading(false);
          });
        }, []);

        return React.createElement("div", { className: "bg-slate-50 min-h-screen animate-fade-in pb-32" },
          React.createElement("div", { className: "bg-slate-900 text-white p-6 sticky top-0 z-40 flex justify-between items-center shadow-xl" }, 
            React.createElement("h2", { className: "text-lg font-black" }, "È†êÁ¥ÑÊéßÁÆ°ÂæåÂè∞"), 
            React.createElement("button", { onClick: onBack, className: "text-xs opacity-70" }, "ËøîÂõû")
          ),
          React.createElement("div", { className: "p-4 space-y-4" },
            loading ? React.createElement("p", { className: "text-center py-10 text-gray-400" }, "ËÆÄÂèñ‰∏≠...") :
            bookings.map(b => React.createElement("div", { key: b.id, className: "bg-white p-5 rounded-3xl shadow-sm border border-gray-100" },
              React.createElement("div", { className: "flex justify-between items-start" },
                React.createElement("div", null, 
                  React.createElement("span", { className: "text-[10px] font-black bg-red-100 text-red-700 px-2 py-1 rounded-md" }, b.bookingCode), 
                  React.createElement("h4", { className: "font-black mt-2 text-lg" }, `${b.name} (${b.adults}Â§ß${b.children}Â∞è)`), 
                  React.createElement("p", { className: "text-xs text-gray-400" }, `${b.date} ${b.time}`)
                ),
                React.createElement("a", { href: `tel:${b.phone}`, className: "p-3 bg-green-50 text-green-600 rounded-full" }, React.createElement(Icon, { name: "phone", className: "w-5 h-5" }))
              ),
              b.preOrder && React.createElement("div", { className: "mt-3 pt-3 border-t border-gray-50" },
                React.createElement("p", { className: "text-xs text-gray-500 font-bold" }, "È†êÈªûÈ§êÈªûÔºö"),
                React.createElement("p", { className: "text-xs text-slate-700" }, b.preOrder)
              )
            ))
          )
        );
    };

    const App = () => {
      const [view, setView] = useState('HOME');
      const [data, setData] = useState({});
      const [profile, setProfile] = useState(null);
      const [loading, setLoading] = useState(true);
      const [showChef, setShowChef] = useState(false);
      const [cart, setCart] = useState([]);

      useEffect(() => {
        const init = async () => {
          try {
            if (window.liff) {
              await window.liff.init({ liffId: LIFF_ID });
              if (window.liff.isLoggedIn()) {
                const p = await window.liff.getProfile();
                setProfile(p);
                const res = await runGAS('getInitialData', { lineUserId: p.userId });
                if (res.status === 'success') setData(res);
              } else {
                 // Auto login or guest mode
                 // window.liff.login(); 
              }
            }
          } catch (e) { console.error(e); }
          finally {
            setLoading(false);
            setTimeout(() => {
              const overlay = document.getElementById('loading-overlay');
              if (overlay) { overlay.style.opacity = '0'; setTimeout(() => overlay.style.display = 'none', 600); }
            }, 800);
          }
        };
        init();
      }, []);

      const addToCart = (item) => {
        setCart(prev => {
          const exist = prev.find(i => i.Áî¢ÂìÅÂêçÁ®± === item.Áî¢ÂìÅÂêçÁ®±);
          if (exist) return prev.map(i => i.Áî¢ÂìÅÂêçÁ®± === item.Áî¢ÂìÅÂêçÁ®± ? { ...i, qty: i.qty + 1 } : i);
          return [...prev, { ...item, qty: 1 }];
        });
        Swal.fire({
          title: 'Â∑≤Âä†ÂÖ•È†êÈªû',
          text: `${item.Áî¢ÂìÅÂêçÁ®±} Â∑≤Âä†ÂÖ•ÔºÅÈ†êÁ¥ÑÊôÇÂ∞á‰∏Ä‰ΩµÈÄÅÂá∫„ÄÇ`,
          icon: 'success',
          toast: true, position: 'top-end', showConfirmButton: false, timer: 1500
        });
      };

      const MemberView = () => {
         const isAdmin = useMemo(() => {
            if (!data.member?.ÈõªË©±) return false;
            const phone = String(data.member.ÈõªË©±).replace(/[^0-9]/g, '');
            return ADMIN_PHONES.includes(phone);
         }, [data.member]);

         if (!data.member) return React.createElement("div", { className: "p-10 text-center" }, React.createElement("h3", { className: "font-black text-xl mb-2" }, "Â∞öÊú™Âä†ÂÖ•ÊúÉÂì°"), React.createElement("button", { className: "btn-primary", onClick: () => setView('BOOKING') }, "Á´ãÂç≥Ë®Ç‰Ωç‰∏¶Ë®ªÂÜä"));

         return React.createElement("div", { className: "p-6 animate-fade-in pb-32" },
            React.createElement("div", { className: "bg-gradient-to-br from-red-700 to-black p-8 rounded-[2.5rem] text-white shadow-2xl mb-8" },
              React.createElement("p", { className: "text-[10px] font-black opacity-30 uppercase tracking-[0.3em] mb-12" }, RESTAURANT_NAME),
              React.createElement("div", { className: "flex justify-between items-end" },
                React.createElement("div", null, React.createElement("h3", { className: "text-xl font-black" }, data.member.ÂßìÂêç), React.createElement("p", { className: "font-mono opacity-50 text-xs mt-1" }, data.member.ÈõªË©±)),
                React.createElement("div", { className: "text-right" }, React.createElement("p", { className: "text-[10px] opacity-40 font-black" }, "Points"), React.createElement("p", { className: "text-4xl font-black" }, data.member.ÈªûÊï∏ || 0))
              )
            ),
            isAdmin && React.createElement("button", { onClick: () => setView('ADMIN'), className: "w-full bg-slate-900 text-white py-5 rounded-3xl font-black flex items-center justify-center gap-3 mb-6 shadow-xl active:scale-95 transition-all" }, React.createElement(Icon, { name: "chart", className: "w-5 h-5 text-amber-400" }), "ÁÆ°ÁêÜÂì°ÂæåÂè∞"),
            React.createElement("div", { className: "grid grid-cols-2 gap-4" },
              React.createElement("button", { className: "bg-white p-6 rounded-3xl border border-gray-100 flex flex-col items-center gap-3" }, React.createElement(Icon, { name: "calendar", className: "w-6 h-6 text-red-700" }), React.createElement("span", { className: "font-black text-sm" }, "ÊàëÁöÑË®Ç‰Ωç")),
              React.createElement("button", { className: "bg-white p-6 rounded-3xl border border-gray-100 flex flex-col items-center gap-3" }, React.createElement(Icon, { name: "gift", className: "w-6 h-6 text-red-700" }), React.createElement("span", { className: "font-black text-sm" }, "ÈªûÊï∏Á¥ÄÈåÑ"))
            )
         );
      };

      const renderView = () => {
        if (view === 'ADMIN') return React.createElement(AdminDashboard, { profile, onBack: () => setView('MEMBER') });
        switch(view) {
          case 'BOOKING': return React.createElement(BookingView, { profile, onComplete: () => setView('HOME'), cart, onClearCart: () => setCart([]) });
          case 'MENU': return React.createElement(MenuView, { menu: data.restaurantMenu || [], addToCart, cart });
          case 'INFO': return React.createElement("div", { className: "p-6 space-y-6 animate-fade-in pb-32" },
            React.createElement("div", { className: "bg-white p-6 rounded-3xl border border-gray-100 shadow-sm" }, 
                React.createElement("h3", { className: "font-black text-xl mb-4" }, "Â∫óÂÆ∂Ë≥áË®ä"), 
                React.createElement("p", { className: "text-sm text-gray-600 mb-2" }, "üìû 082-311211"), 
                React.createElement("p", { className: "text-sm text-gray-600" }, "üìç ÈáëÈñÄÁ∏£ÈáëÂØßÈÑâ‰ºØÁéâË∑Ø‰∫åÊÆµ")
            ),
            React.createElement("div", { className: "bg-white p-6 rounded-3xl border border-gray-100 shadow-sm" },
              React.createElement("h3", { className: "font-black text-lg mb-4 flex items-center gap-2" }, React.createElement(Icon, { name: "question", className: "w-5 h-5" }), "Â∏∏Ë¶ãÂïèÈ°å"),
              (data.faqs || []).map((f, i) => React.createElement("details", { key: i, className: "mb-3 border-b border-gray-50 pb-3" }, 
                  React.createElement("summary", { className: "text-sm font-bold cursor-pointer text-slate-700" }, f.ÂïèÈ°å), 
                  React.createElement("p", { className: "text-xs text-gray-400 mt-2 leading-relaxed" }, f.ÂõûÁ≠î)
              ))
            )
          );
          case 'MEMBER': return React.createElement(MemberView);
          default: return React.createElement("div", { className: "animate-fade-in pb-32 p-6" },
            React.createElement("div", { className: "relative h-64 rounded-[2.5rem] overflow-hidden shadow-2xl mb-8 group" },
               React.createElement("img", { src: "https://i.ibb.co/qLFg7gSk/Gemini-Generated-Image-cmj4yzcmj4yzcmj4.png", className: "w-full h-full object-cover group-hover:scale-105 transition-transform duration-700" }),
               React.createElement("div", { className: "absolute inset-0 bg-gradient-to-t from-black/80 to-transparent flex items-end p-8" },
                 React.createElement("div", null, React.createElement("h3", { className: "text-white font-black text-2xl" }, "ÈÅìÂú∞Áæ©ÂºèÔºåÈáëÈñÄÈ£ÑÈ¶ô"), React.createElement("p", { className: "text-[10px] text-white/50 uppercase tracking-widest mt-1" }, "Handmade Pasta & Pizza"))
               )
            ),
            React.createElement("button", { onClick: () => setShowChef(true), className: "w-full bg-slate-900 text-white p-5 rounded-3xl flex items-center justify-between mb-8 shadow-xl active:scale-95 transition-all" },
              React.createElement("div", { className: "flex items-center gap-4" }, React.createElement(Icon, { name: "sparkles", className: "w-6 h-6 text-amber-400" }), React.createElement("div", { className: "text-left" }, React.createElement("p", { className: "text-xs font-black" }, "‰∏çÁü•ÈÅìÂêÉ‰ªÄÈ∫ºÔºü"), React.createElement("p", { className: "text-[10px] opacity-60" }, "ÂïèÂïè AI ‰∏ªÂªö"))),
              React.createElement("span", { className: "bg-amber-400 text-slate-900 px-3 py-1 rounded-full text-[10px] font-black" }, "CHAT")
            ),
            // ÊúÄÊñ∞Ê¥ªÂãï
            data.promotions?.length > 0 && React.createElement("div", { className: "mb-8" },
              React.createElement("h3", { className: "font-black text-lg mb-4 pl-2" }, "ÊúÄÊñ∞Ê¥ªÂãï"),
              React.createElement("div", { className: "flex overflow-x-auto gap-4 no-scrollbar px-2" },
                data.promotions.map((p, i) => React.createElement("div", { key: i, className: "w-72 flex-shrink-0 bg-white rounded-3xl overflow-hidden border border-gray-100 shadow-sm" },
                  React.createElement("img", { src: p.ÂúñÁâáÁ∂≤ÂùÄ, className: "w-full h-32 object-cover" }),
                  React.createElement("div", { className: "p-4" }, React.createElement("h4", { className: "font-black text-sm text-slate-800" }, p.Ê®ôÈ°å), React.createElement("p", { className: "text-[10px] text-gray-400 mt-1" }, p.ÂÖßÂÆπ))
                ))
              )
            ),
             // ‰∏ªÂªöÊé®Ëñ¶
            React.createElement("div", { className: "mb-8" },
              React.createElement("h3", { className: "font-black text-lg mb-4 flex justify-between items-center pl-2" }, "‰∏ªÂªöÂº∑ÂäõÊé®Ëñ¶", React.createElement("button", { onClick: () => setView('MENU'), className: "text-red-700 text-xs font-bold" }, "ÁúãÂÆåÊï¥ËèúÂñÆ")),
              React.createElement("div", { className: "flex overflow-x-auto gap-4 no-scrollbar px-2" },
                (data.chefRecommendations || []).map((item, idx) => React.createElement("div", { key: idx, className: "w-52 flex-shrink-0 bg-white p-4 rounded-3xl border border-gray-100 shadow-sm" },
                  React.createElement("img", { src: item.ÂúñÁâáÁ∂≤ÂùÄ, className: "w-full h-32 object-cover rounded-2xl mb-3" }),
                  React.createElement("h4", { className: "font-black text-sm text-slate-800 truncate" }, item.Áî¢ÂìÅÂêçÁ®±),
                  React.createElement("p", { className: "text-red-700 font-black text-sm mt-1" }, `$${item.Áî¢ÂìÅÂÉπÊ†º}`)
                ))
              )
            )
          );
        }
      };

      if (loading) return null;

      return React.createElement("div", { className: "max-w-md mx-auto min-h-screen bg-white relative shadow-2xl" },
        React.createElement("div", { className: "bg-white p-6 sticky top-0 z-30 flex justify-between items-center glass border-b border-gray-50" },
           React.createElement("div", null, React.createElement("h1", { className: "font-black text-slate-900 text-xl tracking-tighter" }, RESTAURANT_NAME), React.createElement("p", { className: "text-[9px] text-gray-400 font-black uppercase tracking-widest" }, profile?.displayName || "GUEST")),
           profile && React.createElement("img", { src: profile.pictureUrl, className: "w-10 h-10 rounded-xl shadow-md border-2 border-white" })
        ),
        renderView(),
        React.createElement("div", { className: "fixed bottom-6 inset-x-6 h-18 glass border border-white/50 rounded-full shadow-2xl flex items-center justify-around px-4 z-50" },
          [
            { id: 'HOME', icon: 'home', label: 'È¶ñÈ†Å' },
            { id: 'MENU', icon: 'menu', label: 'ËèúÂñÆ' },
            { id: 'BOOKING', icon: 'calendar', label: 'Ë®Ç‰Ωç' },
            { id: 'INFO', icon: 'info', label: 'Ë≥áË®ä' },
            { id: 'MEMBER', icon: 'user', label: 'ÊúÉÂì°' }
          ].map(item => React.createElement("button", {
            key: item.id,
            onClick: () => setView(item.id),
            className: `flex flex-col items-center gap-1 transition-all ${view === item.id ? 'text-red-700 scale-110' : 'text-gray-400'}`
          },
            React.createElement("div", { className: "relative" },
               React.createElement(Icon, { name: item.icon, className: "w-6 h-6" }),
               // Ë≥ºÁâ©ËªäÂ∞èÁ¥ÖÈªû
               item.id === 'MENU' && cart.length > 0 && React.createElement("span", { className: "absolute -top-1 -right-1 w-3 h-3 bg-red-600 rounded-full border-2 border-white" })
            ),
            React.createElement("span", { className: "text-[9px] font-black" }, item.label)
          ))
        ),
        showChef && React.createElement(ChefChat, { onClose: () => setShowChef(false) })
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(React.createElement(App));
  </script>
</body>
</html>