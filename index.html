<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>è–©è«¾ç“¦ç¾©å¼å»šæˆ¿ - SANOVA KITCHEN</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    :root {
      --brand-main: #B91C1C; /* Red 700 */
      --brand-light: #FEE2E2; /* Red 100 */
      --bg-color: #f8fafc;
    }
    body { 
      font-family: -apple-system, BlinkMacSystemFont, "Microsoft JhengHei", "PingFang TC", sans-serif; 
      background-color: var(--bg-color); 
      margin: 0; padding: 0; overflow-x: hidden;
      -webkit-tap-highlight-color: transparent;
    }
    .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    
    .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); }
    .no-scrollbar::-webkit-scrollbar { display: none; }
    
    /* Loading Overlay */
    #loading-overlay {
      position: fixed; inset: 0; background: #000; display: flex; flex-direction: column;
      align-items: center; justify-content: center; z-index: 9999;
      transition: opacity 0.6s ease;
    }
    #loading-img {
      position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover;
    }
    /* ç§»é™¤è½‰åœˆåœˆèˆ‡æ–‡å­—ï¼Œåªä¿ç•™åœ–ç‰‡ */

    /* UI Components */
    .input-field {
      @apply w-full p-4 border border-gray-200 rounded-2xl bg-gray-50 focus:bg-white focus:ring-2 focus:ring-[#B91C1C] focus:border-transparent outline-none transition-all text-sm font-medium text-slate-700;
    }
    .btn-primary {
      @apply w-full py-4 bg-gradient-to-r from-red-700 to-red-800 text-white rounded-2xl font-black shadow-lg shadow-red-900/30 active:scale-95 transition-all disabled:opacity-50 disabled:active:scale-100 text-lg tracking-wide flex items-center justify-center gap-2;
    }
    .btn-secondary {
      @apply w-full py-3 bg-white border border-gray-200 text-slate-700 rounded-2xl font-bold shadow-sm active:scale-95 transition-all flex items-center justify-center;
    }
    .stepper-btn {
      @apply w-10 h-10 rounded-full bg-gray-100 text-slate-700 font-black text-xl flex items-center justify-center active:bg-red-100 active:text-red-700 transition-colors disabled:opacity-30;
    }
    
    /* POS Receipt Style */
    .pos-receipt {
      font-family: 'Courier New', Courier, monospace;
      border: 2px dashed #000;
      background: #fff;
      padding: 20px;
      color: #000;
    }

    /* Custom Toggle */
    .toggle-checkbox:checked { right: 0; border-color: #B91C1C; }
    .toggle-checkbox:checked + .toggle-label { background-color: #B91C1C; }
  </style>
</head>
<body>
  <div id="loading-overlay">
    <img id="loading-img" src="https://i.ibb.co/wZmHF1MQ/line-oa-chat-260112-192432.jpg" />
  </div>

  <div id="root"></div>

  <script>
    // Polyfill process for browser environment
    window.process = window.process || { env: { API_KEY: '' } };
    window.onerror = function() {
      const el = document.getElementById('loading-overlay');
      if(el) el.style.display = 'none';
    };
  </script>

  <script type="module">
    import React, { useState, useEffect, useMemo, useRef } from 'https://esm.sh/react@18.2.0';
    import ReactDOM from 'https://esm.sh/react-dom@18.2.0/client';

    const LIFF_ID = "2008861231-EA0Hpl68"; 
    const RESTAURANT_NAME = "è–©è«¾ç“¦ç¾©å¼å»šæˆ¿"; 
    const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxHOJOzIGqCnW-ttjB0_OeJ6eIz3iqF3dnYSwGeK4L2vRi6dEuWZ-i_DoM5pHjz9u7PlA/exec";
    const ADMIN_PHONES = ['0937942582', '0978375273', '0978375592'];

    // å®Œæ•´èœå–®è³‡æ–™
    const MOCK_MENU = [
        // ä¸»å»šæ¨è–¦
        { é¡åˆ¥: 'ä¸»å»šæ¨è–¦', ç”¢å“åç¨±: 'å®®ä¿è¾£å‘³é›ä¸ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 210, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ä¸»å»šæ¨è–¦', ç”¢å“åç¨±: 'å®®ä¿è¾£å‘³èŠ±æç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 230, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ä¸»å»šæ¨è–¦', ç”¢å“åç¨±: 'è’œé¦™ç™½é…’è›¤è £ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 250, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ä¸»å»šæ¨è–¦', ç”¢å“åç¨±: 'æ¥µå“X.Oé†¬æµ·é®®ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 260, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ä¸»å»šæ¨è–¦', ç”¢å“åç¨±: 'å¢¨é­šæ±æµ·é®®å¢¨é­šéºµ', ç”¢å“åƒ¹æ ¼: 270, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ä¸»å»šæ¨è–¦', ç”¢å“åç¨±: 'å¢¨é­šæ±è›¤è £å¢¨é­šéºµ', ç”¢å“åƒ¹æ ¼: 270, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ä¸»å»šæ¨è–¦', ç”¢å“åç¨±: 'å¢¨é­šæ±èŠ±æå¢¨é­šéºµ', ç”¢å“åƒ¹æ ¼: 270, æ¨™ç±¤: 'è¾£' },
        
        // PIZZA (7å‹)
        { é¡åˆ¥: 'PIZZA', ç”¢å“åç¨±: 'èŒ„æ±ç”°åœ’æ™‚è”¬æŠ«è–©', ç”¢å“åƒ¹æ ¼: 170, æ¨™ç±¤: 'å¥¶ç´ ' },
        { é¡åˆ¥: 'PIZZA', ç”¢å“åç¨±: 'å—ç“œç”°åœ’æ™‚è”¬æŠ«è–©', ç”¢å“åƒ¹æ ¼: 170, æ¨™ç±¤: 'å¥¶ç´ ' },
        { é¡åˆ¥: 'PIZZA', ç”¢å“åç¨±: 'ç¾©å¼è‚‰é†¬é‡è‡æŠ«è–©', ç”¢å“åƒ¹æ ¼: 170, æ¨™ç±¤: 'å«ç‰›è‚‰' },
        { é¡åˆ¥: 'PIZZA', ç”¢å“åç¨±: 'ç‡»é›ç¶œåˆèŒè‡æŠ«è–©', ç”¢å“åƒ¹æ ¼: 170, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'PIZZA', ç”¢å“åç¨±: 'å¢¨è¥¿å“¥è¾£å‘³é¦™è…¸æŠ«è–©', ç”¢å“åƒ¹æ ¼: 190, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'PIZZA', ç”¢å“åç¨±: 'å¤å¨å¤·è¦ä»æŠ«è–©', ç”¢å“åƒ¹æ ¼: 210, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'PIZZA', ç”¢å“åç¨±: 'ç…™ç‡»é´¨èƒ¸æŠ«è–©', ç”¢å“åƒ¹æ ¼: 210, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'PIZZA', ç”¢å“åç¨±: 'B.B.Qæµ·é®®æŠ«è–©', ç”¢å“åƒ¹æ ¼: 210, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'PIZZA', ç”¢å“åç¨±: 'æ³•å¼é†¬æµ·é®®æŠ«è–©', ç”¢å“åƒ¹æ ¼: 210, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'PIZZA', ç”¢å“åç¨±: 'é»‘æ¾éœ²é‡è‡æŠ«è–©', ç”¢å“åƒ¹æ ¼: 250, æ¨™ç±¤: '' },
        
        // ç™½é†¬ç¾©å¤§åˆ©éºµ
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'ç™½é†¬', ç”¢å“åç¨±: 'å¥¶æ²¹åŸ¹æ ¹ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 180, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'ç™½é†¬', ç”¢å“åç¨±: 'å¥¶æ²¹æ™‚è”¬ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 180, æ¨™ç±¤: 'å¥¶ç´ ' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'ç™½é†¬', ç”¢å“åç¨±: 'è¥¿è¥¿é‡Œå¥¶æ²¹å«©é›ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 180, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'ç™½é†¬', ç”¢å“åç¨±: 'å¢¨è¥¿å“¥è¾£å‘³å«©é›ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 190, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'ç™½é†¬', ç”¢å“åç¨±: 'é»ƒèŠ¥æœ«é„‰æ‘å«©é›ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 190, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'ç™½é†¬', ç”¢å“åç¨±: 'å¥¶æ²¹é¦™è¾£é´¨ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 200, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'ç™½é†¬', ç”¢å“åç¨±: 'å¥¶æ²¹è›¤è £ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 230, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'ç™½é†¬', ç”¢å“åç¨±: 'å¥¶æ²¹æµ·é®®ç¸½åŒ¯ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 230, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'ç™½é†¬', ç”¢å“åç¨±: 'å¥¶æ²¹è¾£å‘³èŠ±æå¢¨é­šéºµ', ç”¢å“åƒ¹æ ¼: 270, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'ç™½é†¬', ç”¢å“åç¨±: 'å¥¶æ²¹é¦™ç‡»é®­é­šç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 280, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'ç™½é†¬', ç”¢å“åç¨±: 'å¥¶æ²¹é¦™çƒ¤é›è…¿æ’ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 300, æ¨™ç±¤: '' },
        
        // èŒ„æ±ç¾©å¤§åˆ©éºµ
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'èŒ„æ±', ç”¢å“åç¨±: 'æ³¢éš†é‚£è‚‰é†¬ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 180, æ¨™ç±¤: 'å«ç‰›è‚‰' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'èŒ„æ±', ç”¢å“åç¨±: 'èŒ„æ±è¾£å‘³åŸ¹æ ¹ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 180, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'èŒ„æ±', ç”¢å“åç¨±: 'èŒ„æ±é„‰æ‘å«©é›ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 180, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'èŒ„æ±', ç”¢å“åç¨±: 'èŒ„æ±è¾£å‘³å¾·å¼é¦™è…¸ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 200, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'èŒ„æ±', ç”¢å“åç¨±: 'èŒ„æ±è¾£å‘³é›ªèŠ±ç‰›ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 230, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'èŒ„æ±', ç”¢å“åç¨±: 'ç²‰ç´…æ¼å¤«æµ·é®®ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 230, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'èŒ„æ±', ç”¢å“åç¨±: 'èŒ„æ±é¦™çƒ¤é›è…¿æ’ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 300, æ¨™ç±¤: '' },
        
        // é’é†¬ç¾©å¤§åˆ©éºµ
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'é’é†¬', ç”¢å“åç¨±: 'ç¾…å‹’é‡è‡ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 190, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'é’é†¬', ç”¢å“åç¨±: 'ç¾…å‹’é„‰æ‘å«©é›ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 200, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'é’é†¬', ç”¢å“åç¨±: 'ç¾…å‹’é›ªèŠ±ç‰›ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 230, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'é’é†¬', ç”¢å“åç¨±: 'ç¾…å‹’å”æšç‚¸é›ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 240, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'é’é†¬', ç”¢å“åç¨±: 'ç¾…å‹’å¤šåˆ©é­šç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 250, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'é’é†¬', ç”¢å“åç¨±: 'ç¾…å‹’æµ·é®®ç¸½åŒ¯ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 250, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'é’é†¬', ç”¢å“åç¨±: 'ç¾…å‹’é¦™ç‡»é®­é­šç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 300, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'é’é†¬', ç”¢å“åç¨±: 'ç¾…å‹’è¾£å‘³é®®å¢¨é­šéºµ', ç”¢å“åƒ¹æ ¼: 300, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'é’é†¬', ç”¢å“åç¨±: 'ç¾…å‹’é¦™çƒ¤é›è…¿æ’ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 320, æ¨™ç±¤: '' },
        
        // å—ç“œç¾©å¤§åˆ©éºµ
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'å—ç“œ', ç”¢å“åç¨±: 'å—ç“œåŸ¹æ ¹ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 180, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'å—ç“œ', ç”¢å“åç¨±: 'å—ç“œæ™‚è”¬ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 180, æ¨™ç±¤: 'å¥¶ç´ ' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'å—ç“œ', ç”¢å“åç¨±: 'å—ç“œé„‰æ‘å«©é›ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 180, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'å—ç“œ', ç”¢å“åç¨±: 'å—ç“œè¾£å‘³é¦™è…¸ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 200, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'å—ç“œ', ç”¢å“åç¨±: 'å—ç“œèŠ±æè¦ä»ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 210, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'å—ç“œ', ç”¢å“åç¨±: 'å—ç“œæµ·é®®ç¸½åŒ¯ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 230, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'å—ç“œ', ç”¢å“åç¨±: 'å—ç“œé¦™çƒ¤é›è…¿æ’ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 300, æ¨™ç±¤: '' },
        
        // å’–å“©ç¾©å¤§åˆ©éºµ
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'å’–å“©', ç”¢å“åç¨±: 'å’–å“©é„‰æ‘å«©é›ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 180, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'å’–å“©', ç”¢å“åç¨±: 'å’–å“©è¾£å‘³å¾·å¼é¦™è…¸ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 200, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'å’–å“©', ç”¢å“åç¨±: 'å’–å“©é›ªèŠ±ç‰›ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 210, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'å’–å“©', ç”¢å“åç¨±: 'å’–å“©å”æšç‚¸é›ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 220, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'å’–å“©', ç”¢å“åç¨±: 'ç´…orç¶ å’–å“©å«©é›ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 200, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'å’–å“©', ç”¢å“åç¨±: 'ç´…orç¶ å’–å“©è¾£å‘³å¾·å¼é¦™è…¸ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 220, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'å’–å“©', ç”¢å“åç¨±: 'ç´…orç¶ å’–å“©é›ªèŠ±ç‰›ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 230, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'å’–å“©', ç”¢å“åç¨±: 'ç´…orç¶ å’–å“©å¤šåˆ©é­šç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 250, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç¾©å¤§åˆ©éºµ', å­é¡åˆ¥: 'å’–å“©', ç”¢å“åç¨±: 'ç´…orç¶ å’–å“©é¦™çƒ¤é›è…¿æ’ç¾©å¤§åˆ©éºµ', ç”¢å“åƒ¹æ ¼: 320, æ¨™ç±¤: 'è¾£' },
        
        // ç¾©å¼ç‡‰é£¯
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'æ³¢éš†é‚£è‚‰é†¬ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 180, æ¨™ç±¤: 'å«ç‰›è‚‰' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'èŒ„æ±è¾£å‘³é¦™è…¸ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 200, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'ç²‰ç´…æ¼å¤«æµ·é®®ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 230, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'å—ç“œæ™‚è”¬ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 180, æ¨™ç±¤: 'å¥¶ç´ ' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'å—ç“œå¾·å¼é¦™è…¸ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 200, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'ç¾…å‹’é„‰æ‘å«©é›ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 200, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'ç¾…å‹’å”æšç‚¸é›ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 240, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'ç¾…å‹’é¦™ç‡»é®­é­šç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 300, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'ç¾…å‹’é¦™çƒ¤é›è…¿æ’ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 320, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'å¥¶æ²¹ç‡»é›ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 180, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'å¥¶æ²¹åŸ¹æ ¹ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 180, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'å¥¶æ²¹é¦™è¾£ç‡»é´¨ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 200, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'å¥¶æ²¹è¥¿ç­ç‰™ç´…æ¤’å«©é›ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 200, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'å¥¶æ²¹è¥¿ç­ç‰™ç´…æ¤’é›ªèŠ±ç‰›ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 230, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'å¥¶æ²¹é¦™çƒ¤é›è…¿æ’ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 300, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'å’–å“©é„‰æ‘å«©é›ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 180, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'å’–å“©å”æšç‚¸é›ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 220, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'å’–å“©é¦™çƒ¤é›è…¿æ’ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 300, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'ç´…å’–å“©orç¶ å’–å“©é„‰æ‘å«©é›ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 200, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'å®®ä¿è¾£å‘³é›ä¸ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 210, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'å¢¨é­šæ±èŠ±æç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 240, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'å¢¨é­šæ±æµ·é®®ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 260, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç¾©å¼ç‡‰é£¯', ç”¢å“åç¨±: 'å¤å­£é»‘æ¾éœ²é‡è‡ç‡‰é£¯', ç”¢å“åƒ¹æ ¼: 300, æ¨™ç±¤: '' },
        
        // ç„—çƒ¤ (ç­†å°–éºµ)
        { é¡åˆ¥: 'ç„—çƒ¤', ç”¢å“åç¨±: 'ç„—çƒ¤æ³¢éš†é‚£è‚‰é†¬ç­†å°–éºµ', ç”¢å“åƒ¹æ ¼: 230, æ¨™ç±¤: 'å«ç‰›è‚‰' },
        { é¡åˆ¥: 'ç„—çƒ¤', ç”¢å“åç¨±: 'ç„—çƒ¤å¥¶æ²¹å«©é›ç­†å°–éºµ', ç”¢å“åƒ¹æ ¼: 230, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç„—çƒ¤', ç”¢å“åç¨±: 'ç„—çƒ¤å’–å“©å«©é›ç­†å°–éºµ', ç”¢å“åƒ¹æ ¼: 230, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç„—çƒ¤', ç”¢å“åç¨±: 'ç„—çƒ¤é’é†¬å«©é›ç­†å°–éºµ', ç”¢å“åƒ¹æ ¼: 250, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç„—çƒ¤', ç”¢å“åç¨±: 'ç„—çƒ¤ç´…å’–å“©é„‰æ‘å«©é›ç­†å°–éºµ', ç”¢å“åƒ¹æ ¼: 250, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç„—çƒ¤', ç”¢å“åç¨±: 'ç„—çƒ¤ç¶ å’–å“©é„‰æ‘å«©é›ç­†å°–éºµ', ç”¢å“åƒ¹æ ¼: 250, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç„—çƒ¤', ç”¢å“åç¨±: 'ç„—çƒ¤èŒ„æ±è¾£å‘³é¦™è…¸ç­†å°–éºµ', ç”¢å“åƒ¹æ ¼: 250, æ¨™ç±¤: 'è¾£' },
        { é¡åˆ¥: 'ç„—çƒ¤', ç”¢å“åç¨±: 'ç„—çƒ¤å’–å“©é›ªèŠ±ç‰›ç­†å°–éºµ', ç”¢å“åƒ¹æ ¼: 260, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç„—çƒ¤', ç”¢å“åç¨±: 'ç„—çƒ¤å¥¶æ²¹æµ·é®®ç­†å°–éºµ', ç”¢å“åƒ¹æ ¼: 280, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç„—çƒ¤', ç”¢å“åç¨±: 'ç„—çƒ¤é»‘æ¾éœ²é‡è‡ç­†å°–éºµ', ç”¢å“åƒ¹æ ¼: 350, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç„—çƒ¤', ç”¢å“åç¨±: 'ç„—çƒ¤å¥¶æ²¹é¦™çƒ¤é›è…¿æ’ç­†å°–éºµ', ç”¢å“åƒ¹æ ¼: 350, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç„—çƒ¤', ç”¢å“åç¨±: 'ç„—çƒ¤å’–å“©é¦™çƒ¤é›è…¿æ’ç­†å°–éºµ', ç”¢å“åƒ¹æ ¼: 350, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'ç„—çƒ¤', ç”¢å“åç¨±: 'ç„—çƒ¤ç¾…å‹’é¦™çƒ¤é›è…¿æ’ç­†å°–éºµ', ç”¢å“åƒ¹æ ¼: 370, æ¨™ç±¤: '' },
        
        // å–®é»
        { é¡åˆ¥: 'å–®é»', ç”¢å“åç¨±: 'éº¥å…‹é›å¡Š', ç”¢å“åƒ¹æ ¼: 90, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'å–®é»', ç”¢å“åç¨±: 'ç¾å¼è„†è–¯', ç”¢å“åƒ¹æ ¼: 90, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'å–®é»', ç”¢å“åç¨±: 'æ´‹è”¥åœˆ', ç”¢å“åƒ¹æ ¼: 90, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'å–®é»', ç”¢å“åç¨±: 'æª¸æª¬é›æŸ³æ¢', ç”¢å“åƒ¹æ ¼: 90, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'å–®é»', ç”¢å“åç¨±: 'ç¾©å¼ç„—çƒ¤æé®‘è‡', ç”¢å“åƒ¹æ ¼: 120, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'å–®é»', ç”¢å“åç¨±: 'ç´æ¾³è‰¯é¦™è¾£çƒ¤é›ç¿…', ç”¢å“åƒ¹æ ¼: 160, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'å–®é»', ç”¢å“åç¨±: 'è’œé¦™éºµåŒ…(2å€‹)', ç”¢å“åƒ¹æ ¼: 40, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'å–®é»', ç”¢å“åç¨±: 'å·§é”æ¿ƒæ¹¯', ç”¢å“åƒ¹æ ¼: 60, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'å–®é»', ç”¢å“åç¨±: 'é…¥çš®æ¿ƒæ¹¯', ç”¢å“åƒ¹æ ¼: 110, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'å–®é»', ç”¢å“åç¨±: 'åŠ é£¯oråŠ éºµ', ç”¢å“åƒ¹æ ¼: 40, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'å–®é»', ç”¢å“åç¨±: 'åŠ ç„—çƒ¤', ç”¢å“åƒ¹æ ¼: 50, æ¨™ç±¤: '' },
        
        // é£²å“
        { é¡åˆ¥: 'é£²å“', ç”¢å“åç¨±: 'å¯æ¨‚', ç”¢å“åƒ¹æ ¼: 50, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'é£²å“', ç”¢å“åç¨±: 'é›ªç¢§', ç”¢å“åƒ¹æ ¼: 50, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'é£²å“', ç”¢å“åç¨±: 'è˜‹æœè¥¿æ‰“', ç”¢å“åƒ¹æ ¼: 50, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'é£²å“', ç”¢å“åç¨±: 'å¯çˆ¾å¿…æ€', ç”¢å“åƒ¹æ ¼: 60, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'é£²å“', ç”¢å“åç¨±: 'ç´…èŒ¶ (å†°/ç†±)', ç”¢å“åƒ¹æ ¼: 60, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'é£²å“', ç”¢å“åç¨±: 'ç¶ èŒ¶ (ç†±)', ç”¢å“åƒ¹æ ¼: 60, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'é£²å“', ç”¢å“åç¨±: 'å¥¶èŒ¶ (å†°/ç†±)', ç”¢å“åƒ¹æ ¼: 60, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'é£²å“', ç”¢å“åç¨±: 'å¥¶ç¶  (ç†±)', ç”¢å“åƒ¹æ ¼: 60, æ¨™ç±¤: '' },
        { é¡åˆ¥: 'é£²å“', ç”¢å“åç¨±: 'æ¡‚èŠ±èœœèŒ¶ (å†°)', ç”¢å“åƒ¹æ ¼: 60, æ¨™ç±¤: '' }
    ];

    // é©—è­‰
    const isValidPhone = (phone) => /^09\d{8}$/.test(phone);

    // Icons
    const Icon = ({ name, className }) => {
      const paths = {
        home: "M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6",
        menu: "M4 6h16M4 12h16M4 18h16",
        calendar: "M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2-2H5a2 2 0 00-2-2H5a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z",
        user: "M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z",
        back: "M10 19l-7-7m0 0l7-7m-7 7h18",
        info: "M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",
        phone: "M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z",
        chart: "M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z",
        gift: "M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7",
        sparkles: "M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-7.714 2.143L11 21l-2.286-6.857L1 12l7.714-2.143L11 3z",
        question: "M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z",
        trash: "M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16",
        x: "M6 18L18 6M6 6l12 12",
        download: "M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4",
        search: "M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",
        edit: "M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z",
        printer: "M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z",
        check: "M5 13l4 4L19 7"
      };
      return React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className, fill: "none", viewBox: "0 0 24 24", stroke: "currentColor", strokeWidth: "2" },
        React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: paths[name] || "" })
      );
    };

    // --- Product Modal ---
    const ProductModal = ({ item, onClose, onAdd }) => {
        const [qty, setQty] = useState(1);
        const [noodle, setNoodle] = useState(null);
        const [combo, setCombo] = useState(null);
        const [drink, setDrink] = useState(null);
        const [spice, setSpice] = useState(item.æ¨™ç±¤?.includes('è¾£') ? 'å›ºå®šè¾£åº¦' : 'ä¸è¾£');

        const isPasta = item.é¡åˆ¥?.includes('ç¾©å¤§åˆ©éºµ');
        const noodleOptions = [
            { id: 'penne', name: 'ç­†å°–éºµ', price: 0 },
            { id: 'risotto', name: 'ç‡‰é£¯', price: 0 },
            { id: 'angel', name: 'å¤©ä½¿ç´°éºµ', price: 10 },
            { id: 'macaroni', name: 'é€šå¿ƒéºµ', price: 10 },
            { id: 'linguine', name: 'ç´°æ‰éºµ', price: 10 },
            { id: 'squid', name: 'å¢¨é­šéºµ', price: 40 }
        ];
        const comboOptions = [
            { id: 'none', name: 'å–®é»', price: 0 },
            { id: 'value', name: 'è¶…å€¼å¥—é¤ (+éºµåŒ…/æ¿ƒæ¹¯/é£²å“)', price: 79 },
            { id: 'puff', name: 'é…¥çš®å¥—é¤ (+éºµåŒ…/é…¥çš®æ¹¯/é£²å“)', price: 129 }
        ];
        const drinkOptions = ['å¯æ¨‚','é›ªç¢§','è˜‹æœè¥¿æ‰“','å¯çˆ¾å¿…æ€','ç´…èŒ¶(å†°)','ç´…èŒ¶(ç†±)','ç¶ èŒ¶(ç†±)','å¥¶èŒ¶(å†°)','å¥¶èŒ¶(ç†±)','æ¡‚èŠ±èœœèŒ¶(å†°)'];
        const spiceOptions = ['ä¸è¾£', 'å°è¾£', 'ä¸­è¾£', 'å¤§è¾£'];

        const canAdd = () => {
            if (isPasta && !noodle) return false;
            if (combo && combo.id !== 'none' && !drink) return false;
            return true;
        };

        const handleAdd = () => {
            if (!canAdd()) return;
            const finalPrice = item.ç”¢å“åƒ¹æ ¼ + (noodle?.price || 0) + (combo?.price || 0);
            onAdd({
                ...item, qty, noodle: noodle?.name, combo: combo?.name, drink, spice, finalPrice
            });
            onClose();
        };

        return React.createElement("div", { className: "fixed inset-0 z-[60] flex items-end sm:items-center justify-center pointer-events-none" },
            React.createElement("div", { className: "absolute inset-0 bg-black/60 pointer-events-auto backdrop-blur-sm", onClick: onClose }),
            React.createElement("div", { className: "bg-white w-full sm:w-[90%] max-w-md rounded-t-[2rem] sm:rounded-[2rem] p-6 pointer-events-auto max-h-[85vh] overflow-y-auto animate-fade-in pb-20 relative" },
                React.createElement("button", { onClick: onClose, className: "absolute top-4 right-4 p-2 bg-gray-100 rounded-full" }, React.createElement(Icon, { name: "x", className: "w-5 h-5" })),
                React.createElement("h3", { className: "font-black text-xl mb-1 pr-8" }, item.ç”¢å“åç¨±),
                React.createElement("p", { className: "text-red-700 font-black text-lg mb-4" }, `$${item.ç”¢å“åƒ¹æ ¼}`),
                
                isPasta && React.createElement("div", { className: "mb-6" },
                    React.createElement("p", { className: "text-sm font-bold mb-2 flex items-center" }, "é¸æ“‡éºµæ¢", React.createElement("span", { className: "ml-2 text-[10px] text-red-500 bg-red-50 px-2 py-0.5 rounded" }, "å¿…é¸")),
                    React.createElement("div", { className: "grid grid-cols-2 gap-2" },
                        noodleOptions.map(opt => React.createElement("button", {
                            key: opt.id,
                            onClick: () => setNoodle(opt),
                            className: `py-2 px-3 rounded-xl text-xs font-bold border transition-all ${noodle?.id === opt.id ? 'bg-red-700 text-white border-red-700' : 'bg-white border-gray-200 text-gray-600'}`
                        }, `${opt.name} ${opt.price > 0 ? `+$${opt.price}` : ''}`))
                    )
                ),

                item.æ¨™ç±¤?.includes('è¾£') ? 
                    React.createElement("div", { className: "mb-6 p-3 bg-red-50 rounded-xl text-xs text-red-800 font-bold" }, "ğŸŒ¶ï¸ æ­¤é¤é»ç‚ºå›ºå®šè¾£åº¦") :
                    React.createElement("div", { className: "mb-6" },
                        React.createElement("p", { className: "text-sm font-bold mb-2" }, "è¾£åº¦èª¿æ•´"),
                        React.createElement("div", { className: "flex gap-2" }, spiceOptions.map(s => React.createElement("button", { key: s, onClick: () => setSpice(s), className: `flex-1 py-2 rounded-xl text-xs font-bold border ${spice === s ? 'bg-orange-500 text-white border-orange-500' : 'border-gray-200'}` }, s)))
                    ),

                React.createElement("div", { className: "mb-6" },
                     React.createElement("p", { className: "text-sm font-bold mb-2" }, "è¶…å€¼å‡ç´š?"),
                     React.createElement("div", { className: "space-y-2" }, comboOptions.map(c => React.createElement("button", {
                         key: c.id, onClick: () => { setCombo(c); if(c.id === 'none') setDrink(null); },
                         className: `w-full text-left p-3 rounded-xl border flex justify-between items-center transition-all ${combo?.id === c.id ? 'bg-amber-50 border-amber-400 ring-1 ring-amber-400' : 'border-gray-200'}`
                     }, React.createElement("span", { className: "text-sm font-bold" }, c.name), React.createElement("span", { className: "text-xs font-black" }, c.price > 0 ? `+$${c.price}` : ''))))
                ),

                combo && combo.id !== 'none' && React.createElement("div", { className: "mb-6 animate-fade-in" },
                     React.createElement("p", { className: "text-sm font-bold mb-2" }, "é¸æ“‡é£²å“ (å¥—é¤é™„)"),
                     React.createElement("div", { className: "grid grid-cols-2 gap-2" }, drinkOptions.map(d => React.createElement("button", {
                         key: d, onClick: () => setDrink(d),
                         className: `py-2 rounded-xl text-xs font-bold border ${drink === d ? 'bg-amber-500 text-white border-amber-500' : 'border-gray-200'}`
                     }, d)))
                ),

                React.createElement("div", { className: "flex items-center justify-between mt-8 pt-4 border-t" },
                    React.createElement("div", { className: "flex items-center gap-4 bg-gray-100 rounded-full px-4 py-2" },
                        React.createElement("button", { onClick: () => setQty(Math.max(1, qty-1)), className: "font-black text-lg" }, "-"),
                        React.createElement("span", { className: "font-black" }, qty),
                        React.createElement("button", { onClick: () => setQty(qty+1), className: "font-black text-lg" }, "+")
                    ),
                    React.createElement("button", { onClick: handleAdd, disabled: !canAdd(), className: "bg-red-700 text-white px-8 py-3 rounded-full font-black shadow-lg disabled:opacity-50 disabled:shadow-none transition-all active:scale-95" }, "åŠ å…¥é é»")
                )
            )
        );
    };

    // --- Views ---

    const HomeView = ({ data, setView }) => React.createElement("div", { className: "animate-fade-in pb-32 p-6" },
        React.createElement("div", { className: "relative h-72 rounded-[2.5rem] overflow-hidden shadow-2xl shadow-red-900/20 mb-8 group" },
           React.createElement("img", { src: "https://i.ibb.co/qLFg7gSk/Gemini-Generated-Image-cmj4yzcmj4yzcmj4.png", className: "w-full h-full object-cover group-hover:scale-105 transition-transform duration-700" }),
           React.createElement("div", { className: "absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent flex items-end p-8" },
             React.createElement("div", null, React.createElement("h3", { className: "text-white font-black text-3xl tracking-tight" }, "é“åœ°ç¾©å¼ï¼Œé‡‘é–€é£„é¦™"), React.createElement("p", { className: "text-xs text-white/70 uppercase tracking-widest mt-2 font-bold" }, "SANOVA KITCHEN"))
           )
        ),
        React.createElement("div", { className: "grid grid-cols-2 gap-4 mb-8" },
            [
                { id: 'BOOKING', label: 'ç·šä¸Šè¨‚ä½', icon: 'calendar', color: 'from-red-600 to-red-700', sub: 'Book Now' },
                { id: 'MENU', label: 'ç€è¦½èœå–®', icon: 'menu', color: 'from-amber-500 to-amber-600', sub: 'Our Menu' },
                { id: 'MEMBER', label: 'æœƒå“¡ä¸­å¿ƒ', icon: 'user', color: 'from-slate-700 to-slate-800', sub: 'Member' },
                { id: 'INFO', label: 'åº—å®¶è³‡è¨Š', icon: 'info', color: 'from-emerald-600 to-emerald-700', sub: 'Info' },
                { id: 'PROMO', label: 'æ´»å‹•å„ªæƒ ', icon: 'sparkles', color: 'from-purple-600 to-purple-700', sub: 'News', action: () => document.getElementById('news-section').scrollIntoView({ behavior: 'smooth' }) },
                { id: 'FAQ', label: 'å¸¸è¦‹å•é¡Œ', icon: 'question', color: 'from-blue-600 to-blue-700', sub: 'FAQ' }
            ].map(btn => React.createElement("button", { 
                key: btn.id, 
                onClick: btn.action || (() => setView(btn.id)),
                className: `relative overflow-hidden p-5 rounded-3xl shadow-lg active:scale-95 transition-all text-left group bg-gradient-to-br ${btn.color}`
            },
                React.createElement("div", { className: "absolute right-[-10px] top-[-10px] opacity-20 rotate-12 group-hover:scale-110 transition-transform" }, React.createElement(Icon, { name: btn.icon, className: "w-20 h-20 text-white" })),
                React.createElement("div", { className: "relative z-10 text-white" },
                    React.createElement(Icon, { name: btn.icon, className: "w-6 h-6 mb-3" }),
                    React.createElement("p", { className: "font-black text-lg leading-tight" }, btn.label),
                    React.createElement("p", { className: "text-[10px] font-bold opacity-60 uppercase tracking-widest mt-1" }, btn.sub)
                )
            ))
        ),
        React.createElement("div", { id: "news-section", className: "mb-8" },
          React.createElement("h3", { className: "font-black text-xl mb-4 pl-2" }, "æœ€æ–°æ´»å‹•èˆ‡å„ªæƒ "),
          data.promotions?.length > 0 ? React.createElement("div", { className: "flex overflow-x-auto gap-4 no-scrollbar px-2" },
            data.promotions.map((p, i) => React.createElement("div", { key: i, className: "w-72 flex-shrink-0 bg-white rounded-3xl overflow-hidden border border-gray-100 shadow-md" },
              React.createElement("img", { src: p.åœ–ç‰‡ç¶²å€, className: "w-full h-36 object-cover" }),
              React.createElement("div", { className: "p-5" }, 
                  React.createElement("span", { className: "text-[10px] bg-red-100 text-red-700 px-2 py-1 rounded-full font-bold mb-2 inline-block" }, p.é¡å‹ || 'NEWS'),
                  React.createElement("h4", { className: "font-black text-base text-slate-800" }, p.æ¨™é¡Œ), 
                  React.createElement("p", { className: "text-xs text-gray-400 mt-2 leading-relaxed" }, p.å…§å®¹)
              )
            ))
          ) : React.createElement("p", { className: "text-center text-gray-400 text-sm py-4" }, "ç›®å‰æ²’æœ‰æœ€æ–°æ´»å‹•")
        )
    );

    const MenuView = ({ menu, addToCart, cart, setView, onSubmitPreorder }) => {
        const [activeCat, setActiveCat] = useState("å…¨éƒ¨é¤é»");
        const [showImage, setShowImage] = useState(null);
        const [selectedItem, setSelectedItem] = useState(null);
        const categories = ["å…¨éƒ¨é¤é»", "ç†±é–€æ¨è–¦", "ç™½é†¬", "èŒ„æ±", "é’é†¬", "å—ç“œ", "å’–å“©", "ä¸»å»šæ¨è–¦", "ç¾©å¼ç‡‰é£¯", "ç„—çƒ¤", "PIZZA", "å–®é»", "é£²å“"];
        
        // å¦‚æœæ²’æœ‰å¾å¾Œç«¯æ‹¿åˆ°èœå–®ï¼Œå°±ä½¿ç”¨ Mock Data
        const displayMenu = (menu && menu.length > 0) ? menu : MOCK_MENU;

        const filteredItems = useMemo(() => {
            return displayMenu.filter(i => {
                if (activeCat === 'å…¨éƒ¨é¤é»') return true;
                if (activeCat === 'ç†±é–€æ¨è–¦') return i.é¡åˆ¥ === 'ä¸»å»šæ¨è–¦' || i.é¡åˆ¥ === 'PIZZA';
                if (activeCat.includes('ç™½é†¬')) return i.é¡åˆ¥ === 'ç¾©å¤§åˆ©éºµ' && i.å­é¡åˆ¥ === 'ç™½é†¬';
                if (activeCat.includes('èŒ„æ±')) return i.é¡åˆ¥ === 'ç¾©å¤§åˆ©éºµ' && i.å­é¡åˆ¥ === 'èŒ„æ±';
                if (activeCat.includes('é’é†¬')) return i.é¡åˆ¥ === 'ç¾©å¤§åˆ©éºµ' && i.å­é¡åˆ¥ === 'é’é†¬';
                if (activeCat.includes('å—ç“œ')) return i.é¡åˆ¥ === 'ç¾©å¤§åˆ©éºµ' && i.å­é¡åˆ¥ === 'å—ç“œ';
                if (activeCat.includes('å’–å“©')) return i.é¡åˆ¥ === 'ç¾©å¤§åˆ©éºµ' && i.å­é¡åˆ¥ === 'å’–å“©';
                return i.é¡åˆ¥ === activeCat || i.å­é¡åˆ¥ === activeCat;
            });
        }, [displayMenu, activeCat]);

        return React.createElement("div", { className: "animate-fade-in pb-32" },
            React.createElement("div", { className: "p-4 grid grid-cols-2 gap-4" },
                [
                    { thumb: "https://i.ibb.co/XZQx4dWc/S-36053013-0.jpg", full: "https://i.ibb.co/TDV3qsnx/2025-page-0001.jpg", label: "èœå–®æ­£é¢" },
                    { thumb: "https://i.ibb.co/dsdPtQKN/S-36053012-0.jpg", full: "https://i.ibb.co/dCKyZ74/2025-page-0002.jpg", label: "èœå–®èƒŒé¢" }
                ].map((img, i) => React.createElement("div", { key: i, className: "relative group cursor-pointer", onClick: () => setShowImage(img) },
                    React.createElement("img", { src: img.thumb, className: "w-full rounded-2xl shadow-md border border-gray-100" }),
                    React.createElement("div", { className: "absolute inset-0 bg-black/20 group-hover:bg-black/40 rounded-2xl transition-all flex items-center justify-center" },
                        React.createElement("span", { className: "text-white text-xs font-bold bg-black/50 px-3 py-1 rounded-full backdrop-blur-sm" }, "é»æ“Šæ”¾å¤§")
                    ),
                    React.createElement("p", { className: "text-center text-xs text-gray-500 mt-2 font-bold" }, img.label)
                ))
            ),
            
            showImage && React.createElement("div", { className: "fixed inset-0 z-[70] bg-black/95 flex flex-col items-center justify-center p-4 animate-fade-in" },
                React.createElement("div", { className: "absolute top-4 right-4 flex gap-4" },
                    React.createElement("a", { href: showImage.full, download: "menu.jpg", target: "_blank", className: "text-white bg-white/20 p-3 rounded-full hover:bg-white/30" }, React.createElement(Icon, { name: "download", className: "w-6 h-6" })),
                    React.createElement("button", { onClick: () => setShowImage(null), className: "text-white bg-red-600 p-3 rounded-full hover:bg-red-700" }, React.createElement(Icon, { name: "x", className: "w-6 h-6" }))
                ),
                React.createElement("img", { src: showImage.full, className: "max-w-full max-h-[80vh] object-contain rounded-lg shadow-2xl" }),
                React.createElement("p", { className: "text-white/70 mt-4 text-sm font-bold" }, showImage.label)
            ),

            React.createElement("div", { className: "h-2 bg-gray-50 my-2" }),

            React.createElement("div", { className: "sticky top-[72px] z-20 bg-white/95 backdrop-blur border-b border-gray-100 overflow-x-auto no-scrollbar flex p-2 gap-2" },
                categories.map(c => React.createElement("button", { 
                    key: c, onClick: () => setActiveCat(c),
                    className: `px-5 py-2 rounded-full text-xs font-black whitespace-nowrap transition-all ${activeCat === c ? 'bg-red-700 text-white shadow-md' : 'bg-gray-100 text-gray-400'}` 
                }, c))
            ),

            React.createElement("div", { className: "p-4 space-y-4" },
                filteredItems.map((item, idx) => {
                    const inCart = cart.find(c => c.ç”¢å“åç¨± === item.ç”¢å“åç¨±);
                    return React.createElement("div", { key: idx, className: "flex gap-4 bg-white p-3 rounded-2xl border border-gray-50 shadow-sm" },
                        React.createElement("div", { className: "relative w-24 h-24 flex-shrink-0" },
                             React.createElement("img", { src: item.åœ–ç‰‡ç¶²å€ || "https://placehold.co/100x100?text=SANOVA", className: "w-full h-full object-cover rounded-xl" }),
                             item.æ¨™ç±¤ && React.createElement("div", { className: "absolute bottom-0 left-0 right-0 flex gap-1 p-1 bg-gradient-to-t from-black/60 to-transparent rounded-b-xl" },
                                item.æ¨™ç±¤.includes('è¾£') && React.createElement("span", { className: "text-[10px]" }, "ğŸŒ¶ï¸"),
                                item.æ¨™ç±¤.includes('ç‰›') && React.createElement("span", { className: "text-[10px]" }, "ğŸ®"),
                                (item.æ¨™ç±¤.includes('ç´ ') || item.ç”¢å“åç¨±.includes('ç´ ')) && React.createElement("span", { className: "text-[10px]" }, "ğŸ¥¦")
                             )
                        ),
                        React.createElement("div", { className: "flex-1 py-1 flex flex-col justify-between" },
                            React.createElement("div", null, 
                                React.createElement("h4", { className: "font-black text-slate-800 text-sm" }, item.ç”¢å“åç¨±),
                                React.createElement("p", { className: "text-[10px] text-gray-400 mt-1 line-clamp-1" }, item.èªªæ˜)
                            ),
                            React.createElement("div", { className: "flex justify-between items-center mt-2" },
                                React.createElement("p", { className: "text-red-700 font-black text-sm" }, `$${item.ç”¢å“åƒ¹æ ¼}`),
                                React.createElement("button", { onClick: () => setSelectedItem(item), className: "bg-red-50 text-red-700 text-[10px] font-black px-4 py-1.5 rounded-full active:scale-95 transition-all" }, "+ é¸è³¼")
                            )
                        )
                    );
                })
            ),
            
            selectedItem && React.createElement(ProductModal, { 
                item: selectedItem, 
                onClose: () => setSelectedItem(null), 
                onAdd: (product) => { addToCart(product); Swal.fire({ toast: true, position: 'top', icon: 'success', title: 'å·²åŠ å…¥è³¼ç‰©è»Š', showConfirmButton: false, timer: 1000 }); }
            }),

            cart.length > 0 && React.createElement("button", { onClick: onSubmitPreorder ? onSubmitPreorder : () => setView('BOOKING'), className: "fixed bottom-24 right-6 bg-red-700 text-white p-4 rounded-full shadow-2xl shadow-red-900/40 z-40 animate-bounce" },
                 React.createElement("div", { className: "relative flex items-center gap-2 px-2" },
                     React.createElement(Icon, { name: "menu", className: "w-6 h-6" }),
                     React.createElement("span", { className: "font-black" }, onSubmitPreorder ? `å®Œæˆè¨‚ä½ ($${cart.reduce((a,c)=>a+c.finalPrice*c.qty,0)})` : cart.reduce((a,c)=>a+c.qty,0))
                 )
            )
        );
    };

    const BookingView = ({ profile, data, onComplete, cart, onClearCart, setView, setPendingBooking, pendingBooking }) => {
      const [form, setForm] = useState(pendingBooking || { 
        date: "", time: "11:30", adults: 2, children: 0, highChairs: 0, vegetarian: false,
        name: data.member?.å§“å || profile?.displayName || "", 
        phone: data.member?.é›»è©±?.replace(/'/g,'') || "", 
        notes: "" 
      });
      const [loading, setLoading] = useState(false);
      const availableTimes = ['11:00', '11:30', '12:00', '12:30', '13:00', '17:00', '17:30', '18:00', '18:30', '19:00', '19:30'];

      useEffect(() => {
          if (!pendingBooking) {
            const tmr = new Date();
            tmr.setDate(tmr.getDate() + 1);
            setForm(f => ({ ...f, date: tmr.toISOString().split('T')[0] }));
          }
      }, []);

      const handleDateChange = (e) => {
        const val = e.target.value;
        if (new Date(val).getDay() === 1) { 
            Swal.fire({ title: 'é€±ä¸€å…¬ä¼‘', text: 'è«‹é¸æ“‡å…¶ä»–æ—¥æœŸ', icon: 'warning', confirmButtonColor: '#B91C1C' });
            setForm({...form, date: ''});
        } else {
            setForm({...form, date: val});
        }
      };

      const handleBooking = async () => {
        if (!data.member && profile) {
           return Swal.fire({ title: 'è«‹å…ˆè¨»å†Š', text: 'ç·šä¸Šè¨‚ä½éœ€å…ˆåŠ å…¥æœƒå“¡', icon: 'info', showCancelButton: true, confirmButtonText: 'å‰å¾€è¨»å†Š', confirmButtonColor: '#B91C1C' }).then(r => { if(r.isConfirmed) setView('MEMBER'); });
        }
        if (!form.date) return Swal.fire('è«‹é¸æ“‡æ—¥æœŸ', '', 'warning');
        if (!form.phone || !isValidPhone(form.phone)) return Swal.fire('æ‰‹æ©Ÿæ ¼å¼éŒ¯èª¤', 'è«‹è¼¸å…¥ 09 é–‹é ­ 10 ç¢¼', 'warning');

        if (cart.length === 0) {
            const result = await Swal.fire({
                title: 'æ˜¯å¦å…ˆé é»é¤é»ï¼Ÿ',
                text: "å…ˆé»é¤å¯ä»¥æ¸›å°‘ç¾å ´ç­‰å€™æ™‚é–“å–”ï¼",
                icon: 'question',
                showCancelButton: true,
                confirmButtonColor: '#B91C1C',
                cancelButtonColor: '#aaa',
                confirmButtonText: 'å¥½ï¼Œå»é»é¤',
                cancelButtonText: 'ä¸ç”¨ï¼Œç›´æ¥è¨‚ä½'
            });

            if (result.isConfirmed) {
                setPendingBooking(form);
                setView('MENU');
                return;
            }
        }
        submitBooking(form);
      };

      const submitBooking = async (bookingData) => {
        setLoading(true);
        const preOrderStr = cart.map(i => {
             let d = `${i.ç”¢å“åç¨±}`;
             if(i.noodle) d += `(${i.noodle})`;
             if(i.combo && i.combo !== 'å–®é»') d += `[${i.combo}/${i.drink}]`;
             if(i.spice) d += `/${i.spice}`;
             return `${d} x${i.qty}`;
        }).join('; ');

        const notesStr = `${bookingData.notes} ${bookingData.vegetarian ? '(æœ‰ç´ é£Ÿéœ€æ±‚)' : ''}`.trim();
        const res = await runGAS('booking', { ...bookingData, notes: notesStr, lineUserId: profile?.userId, preOrder: preOrderStr });
        setLoading(false);
        
        if (res.status === 'success') {
          try {
             if (window.liff && window.liff.isInClient()) {
                const msgText = `ã€è¨‚ä½æˆåŠŸã€‘\nè¨‚ä½ä»£è™Ÿï¼š${res.bookingCode}\næ—¥æœŸï¼š${bookingData.date}\næ™‚é–“ï¼š${bookingData.time}\näººæ•¸ï¼š${bookingData.adults}å¤§${bookingData.children}å°\nå§“åï¼š${bookingData.name}\nå‚™è¨»ï¼š${notesStr}\n\n${preOrderStr ? `ã€é é»é¤é»ã€‘\n${cart.map(i => `- ${i.ç”¢å“åç¨±} (${i.noodle||''}${i.combo!=='å–®é»'?`/${i.combo}`:''}) x${i.qty}`).join('\n')}` : 'ç„¡é é»é¤é»'}`;
                await window.liff.sendMessages([{ type: 'text', text: msgText }]);
             }
          } catch(e) { console.error('LINE Msg Error', e); }

          if (cart.length > 0) onClearCart();
          setPendingBooking(null);
          await Swal.fire({ title: 'é ç´„æˆåŠŸï¼', html: `è¨‚ä½ä»£è™Ÿï¼š<b class="text-2xl text-red-700 block mt-2">${res.bookingCode}</b><br>è¨‚ä½è³‡è¨Šå·²å‚³é€è‡³ LINE`, icon: 'success', confirmButtonColor: '#B91C1C' });
          onComplete();
        } else {
          Swal.fire('ç³»çµ±å¿™ç¢Œ', res.message, 'error');
        }
      };

      return React.createElement("div", { className: "p-6 space-y-6 animate-fade-in pb-32" },
        React.createElement("div", { className: "flex justify-between items-center" },
            React.createElement("h3", { className: "font-black text-2xl text-slate-800" }, "ç·šä¸Šé ç´„"),
            React.createElement("div", { className: "text-right" },
                React.createElement("span", { className: "text-[10px] text-gray-400 block" }, "ç‡Ÿæ¥­æ™‚é–“"),
                React.createElement("span", { className: "text-xs font-bold block" }, "11:00-14:00 / 17:00-20:30")
            )
        ),
        
        cart.length > 0 ? React.createElement("div", { className: "bg-amber-50 p-5 rounded-3xl border border-amber-100 shadow-sm" },
           React.createElement("div", { className: "flex justify-between items-center mb-3" },
               React.createElement("h4", { className: "font-black text-amber-800 text-sm flex items-center gap-2" }, React.createElement(Icon, { name: "menu", className: "w-4 h-4" }), "å·²é é»é¤é»"),
               React.createElement("button", { onClick: onClearCart, className: "text-[10px] text-red-500 underline" }, "æ¸…ç©º")
           ),
           cart.map((item, idx) => React.createElement("div", { key: idx, className: "text-xs text-amber-900 mb-2 border-b border-amber-200/30 pb-1 last:border-0" },
             React.createElement("div", { className: "flex justify-between font-bold" }, React.createElement("span", null, item.ç”¢å“åç¨±), React.createElement("span", null, `x${item.qty}`)),
             React.createElement("div", { className: "text-[10px] opacity-70 mt-0.5" }, 
                 [item.noodle, item.combo!=='å–®é»'?`${item.combo}/${item.drink}`:'', item.spice].filter(Boolean).join(' | ')
             )
           ))
        ) : React.createElement("button", { onClick: () => setView('MENU'), className: "w-full py-4 border-2 border-dashed border-red-200 text-red-400 rounded-3xl font-bold flex items-center justify-center gap-2 hover:bg-red-50 transition-all" }, 
             React.createElement(Icon, { name: "menu", className: "w-5 h-5" }), "é å…ˆé»é¤ (åˆ°åº—å¯å†åŠ é»)" 
        ),

        React.createElement("div", { className: "space-y-6" },
          React.createElement("div", { className: "bg-white p-5 rounded-3xl border border-gray-100 shadow-sm space-y-4" },
             React.createElement("h4", { className: "font-black text-slate-800 text-sm flex items-center gap-2" }, React.createElement(Icon, { name: "calendar", className: "w-4 h-4 text-red-700" }), "ç”¨é¤æ™‚é–“"),
             React.createElement("input", { 
                 type: "date", className: "input-field text-lg text-center font-bold tracking-widest bg-gray-50 rounded-xl", 
                 value: form.date, min: new Date().toISOString().split('T')[0], onChange: handleDateChange 
             }),
             React.createElement("div", { className: "grid grid-cols-4 gap-2" }, availableTimes.map(t => React.createElement("button", { key: t, onClick: () => setForm({...form, time: t}), className: `py-2 rounded-xl text-xs font-bold transition-all ${form.time === t ? 'bg-red-700 text-white shadow-lg scale-105' : 'bg-gray-50 text-gray-400 hover:bg-gray-100'}` }, t)))
          ),
          
          React.createElement("div", { className: "bg-white p-5 rounded-3xl border border-gray-100 shadow-sm space-y-6" },
             React.createElement("h4", { className: "font-black text-slate-800 text-sm flex items-center gap-2" }, React.createElement(Icon, { name: "user", className: "w-4 h-4 text-red-700" }), "ç”¨é¤äººæ•¸"),
             React.createElement("div", { className: "flex justify-between items-center px-2" },
                React.createElement("label", { className: "text-sm font-bold text-gray-700" }, "å¤§äºº"),
                React.createElement("div", { className: "flex items-center gap-4" },
                    React.createElement("button", { onClick: () => setForm({...form, adults: Math.max(1, parseInt(form.adults)-1)}), className: "stepper-btn" }, "-"),
                    React.createElement("span", { className: "text-xl font-black w-8 text-center" }, form.adults),
                    React.createElement("button", { onClick: () => setForm({...form, adults: parseInt(form.adults)+1}), className: "stepper-btn" }, "+")
                )
             ),
             React.createElement("div", { className: "flex justify-between items-center px-2" },
                React.createElement("label", { className: "text-sm font-bold text-gray-700" }, "å°å­©"),
                React.createElement("div", { className: "flex items-center gap-4" },
                    React.createElement("button", { onClick: () => setForm({...form, children: Math.max(0, parseInt(form.children)-1)}), className: "stepper-btn" }, "-"),
                    React.createElement("span", { className: "text-xl font-black w-8 text-center" }, form.children),
                    React.createElement("button", { onClick: () => setForm({...form, children: parseInt(form.children)+1}), className: "stepper-btn" }, "+")
                )
             ),
             React.createElement("div", { className: "flex justify-between items-center px-2 border-t border-gray-100 pt-4" },
                 React.createElement("label", { className: "text-sm font-bold text-gray-700" }, "å…’ç«¥æ¤…", React.createElement("span", { className: "block text-[10px] text-gray-400 font-normal" }, `(æœ€å¤š ${form.children} å¼µ)`)),
                 React.createElement("div", { className: "flex items-center gap-4" },
                    React.createElement("button", { onClick: () => setForm({...form, highChairs: Math.max(0, parseInt(form.highChairs)-1)}), disabled: form.children == 0, className: "stepper-btn" }, "-"),
                    React.createElement("span", { className: "text-xl font-black w-8 text-center" }, form.highChairs),
                    React.createElement("button", { onClick: () => setForm({...form, highChairs: Math.min(parseInt(form.children), parseInt(form.highChairs)+1)}), disabled: form.children == 0 || form.highChairs >= form.children, className: "stepper-btn" }, "+")
                )
             )
          ),

          React.createElement("div", { className: "bg-white p-5 rounded-3xl border-2 border-red-50 shadow-lg shadow-red-50/50 space-y-4" },
             React.createElement("h4", { className: "font-black text-red-800 text-sm flex items-center gap-2 mb-2" }, React.createElement(Icon, { name: "edit", className: "w-4 h-4" }), "è¨‚ä½äººè³‡è¨Š"),
             React.createElement("div", { className: "space-y-3" },
                React.createElement("div", null,
                    React.createElement("label", { className: "text-xs font-bold text-gray-400 mb-1 block pl-1" }, "å§“å"),
                    React.createElement("input", { type: "text", className: "input-field bg-gray-50", value: form.name, readOnly: true, placeholder: "å§“å" })
                ),
                React.createElement("div", null,
                    React.createElement("label", { className: "text-xs font-bold text-gray-400 mb-1 block pl-1" }, "è¯çµ¡é›»è©±"),
                    React.createElement("input", { type: "tel", className: "input-field bg-white border-red-100 focus:border-red-300", value: form.phone, readOnly: !!data.member?.é›»è©±, placeholder: "è«‹è¼¸å…¥æ‰‹æ©Ÿè™Ÿç¢¼ (å¿…å¡«)", onChange: e => setForm({...form, phone: e.target.value}) })
                ),
                React.createElement("div", null,
                    React.createElement("label", { className: "text-xs font-bold text-gray-400 mb-1 block pl-1" }, "å‚™è¨»äº‹é …"),
                    React.createElement("textarea", { className: "input-field h-24 resize-none bg-white", placeholder: "ä¾‹å¦‚: æ…¶ç”Ÿã€éæ•æºã€ç‰¹æ®Šéœ€æ±‚...", value: form.notes, onChange: e => setForm({...form, notes: e.target.value}) })
                ),
                React.createElement("div", { className: "flex items-center justify-between p-2 bg-gray-50 rounded-xl" },
                     React.createElement("label", { className: "text-sm font-bold text-gray-700 flex items-center gap-2" }, "ğŸ¥¦ ç´ é£Ÿéœ€æ±‚", React.createElement("span", { className: "text-[10px] text-gray-400 font-normal" }, "(æä¾›ç´ é£Ÿèœå–®)")),
                     React.createElement("div", { className: "relative inline-block w-12 align-middle select-none" },
                         React.createElement("input", { type: "checkbox", id: "toggle", className: "toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer transition-all duration-300", checked: form.vegetarian, onChange: (e) => setForm({...form, vegetarian: e.target.checked}) }),
                         React.createElement("label", { htmlFor: "toggle", className: `toggle-label block overflow-hidden h-6 rounded-full cursor-pointer transition-colors duration-300 ${form.vegetarian ? 'bg-green-600' : 'bg-gray-300'}` })
                     )
                 )
             )
          )
        ),
        React.createElement("button", { onClick: handleBooking, disabled: loading, className: "btn-primary shadow-2xl shadow-red-900/50 text-lg py-5 mb-8" }, 
            loading ? "è™•ç†ä¸­..." : React.createElement(React.Fragment, null, React.createElement(Icon, { name: "check", className: "w-6 h-6" }), "ç¢ºèªé ç´„")
        )
      );
    };

    const MemberView = ({ data, profile, setView }) => {
        const [isEditing, setIsEditing] = useState(false);
        const [editForm, setEditForm] = useState({});
        const [showHistory, setShowHistory] = useState(null);
        const [historyData, setHistoryData] = useState([]);
        const [loadingHistory, setLoadingHistory] = useState(false);
        const [showRegister, setShowRegister] = useState(false);
        const [regForm, setRegForm] = useState({ name: '', phone: '', birthday: '', gender: 'ç”·', email: '' });

        const isAdmin = useMemo(() => {
            if (!data.member?.é›»è©±) return false;
            const phone = String(data.member.é›»è©±).replace(/[^0-9]/g, '');
            return ADMIN_PHONES.includes(phone);
        }, [data.member]);

        const handleRegister = async () => {
             if(!regForm.name || !regForm.phone || !regForm.birthday) return Swal.fire('è«‹å¡«å¯«å¿…å¡«æ¬„ä½');
             if(!isValidPhone(regForm.phone)) return Swal.fire('æ‰‹æ©Ÿæ ¼å¼éŒ¯èª¤');

             const res = await runGAS('register', { lineUserId: profile.userId, ...regForm });
             if(res.status === 'success') {
                 Swal.fire('è¨»å†ŠæˆåŠŸ', 'ç²å¾— 100 é»å…¥æœƒç¦®ï¼', 'success').then(() => {
                     window.location.reload();
                 });
             } else {
                 Swal.fire('è¨»å†Šå¤±æ•—', res.message || 'è«‹ç¨å¾Œå†è©¦', 'error');
             }
        };

        const handleUpdate = async () => {
            if(!isValidPhone(editForm.é›»è©±)) return Swal.fire('æ‰‹æ©Ÿæ ¼å¼éŒ¯èª¤');
            await runGAS('updateMember', { ...editForm, lineUserId: profile.userId });
            setIsEditing(false);
            window.location.reload();
        };

        const handleDelete = async () => {
             Swal.fire({ title: 'ç¢ºå®šåˆªé™¤å¸³è™Ÿ?', text: 'é»æ•¸å°‡ç„¡æ³•å¾©åŸ', icon: 'warning', showCancelButton: true, confirmButtonColor: '#d33', confirmButtonText: 'åˆªé™¤' })
             .then(async r => {
                 if(r.isConfirmed) {
                     await runGAS('deleteMember', { lineUserId: profile.userId });
                     window.location.reload();
                 }
             });
        };

        const fetchHistory = async (type) => {
            setLoadingHistory(true);
            setShowHistory(type);
            const action = type === 'BOOKINGS' ? 'getUserBookings' : 'getPointHistory';
            const res = await runGAS(action, { lineUserId: profile.userId });
            if(res.status === 'success') {
                setHistoryData(type === 'BOOKINGS' ? res.bookings : res.history);
            }
            setLoadingHistory(false);
        };

        // å¦‚æœè³‡æ–™é‚„æ²’è®€å–å®Œï¼Œé¿å…ç©ºç™½
        if (!data) return React.createElement("div", { className: "p-10 text-center" }, "è®€å–ä¸­...");

        // éæœƒå“¡ç‹€æ…‹ï¼šé¡¯ç¤ºæ¼‚äº®çš„è¨»å†Šå¡ç‰‡
        if (!data.member) {
            return React.createElement("div", { className: "p-6 pb-32 animate-fade-in flex flex-col items-center justify-center min-h-[60vh]" },
                React.createElement("div", { className: "w-full max-w-sm bg-white p-8 rounded-[2.5rem] shadow-xl border border-gray-100 text-center relative overflow-hidden" },
                    React.createElement("div", { className: "absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-red-600 to-red-800" }),
                    React.createElement("div", { className: "w-20 h-20 bg-red-50 rounded-full flex items-center justify-center mx-auto mb-6" }, 
                        React.createElement(Icon, { name: "user", className: "w-10 h-10 text-red-700" })
                    ),
                    React.createElement("h3", { className: "font-black text-2xl mb-2 text-slate-800" }, "åŠ å…¥ SANOVA æœƒå“¡"), 
                    React.createElement("p", { className: "text-gray-500 mb-8 text-sm leading-relaxed" }, "ç´¯ç©é»æ•¸æ›ç¾é£Ÿï¼Œå£½æ˜Ÿäº«å°ˆå±¬å„ªæƒ \nç¾åœ¨è¨»å†Šå³è´ˆé€ 100 é»ï¼"),
                    React.createElement("button", { className: "btn-primary shadow-xl shadow-red-200", onClick: () => setShowRegister(true) }, "ç«‹å³å…è²»è¨»å†Š")
                ),
                
                // è¨»å†Š Modal
                showRegister && React.createElement("div", { className: "fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-fade-in" },
                   React.createElement("div", { className: "bg-white w-full max-w-sm rounded-3xl p-6 shadow-2xl relative" },
                       React.createElement("button", { onClick: () => setShowRegister(false), className: "absolute top-4 right-4 p-2 bg-gray-100 rounded-full" }, React.createElement(Icon, { name: "x", className: "w-5 h-5" })),
                       React.createElement("h3", { className: "font-black text-xl mb-6 text-center" }, "å¡«å¯«æœƒå“¡è³‡æ–™"),
                       React.createElement("div", { className: "space-y-4" },
                           React.createElement("input", { className: "input-field", placeholder: "å§“å (å¿…å¡«)", value: regForm.name, onChange: e => setRegForm({...regForm, name: e.target.value}) }),
                           React.createElement("input", { className: "input-field", type: "tel", placeholder: "æ‰‹æ©Ÿ 09xx (å¿…å¡«)", value: regForm.phone, onChange: e => setRegForm({...regForm, phone: e.target.value}) }),
                           React.createElement("div", { className: "flex gap-2" },
                               React.createElement("input", { className: "input-field flex-1", type: "date", placeholder: "ç”Ÿæ—¥", value: regForm.birthday, onChange: e => setRegForm({...regForm, birthday: e.target.value}) }),
                               React.createElement("select", { className: "input-field w-24", value: regForm.gender, onChange: e => setRegForm({...regForm, gender: e.target.value}) },
                                   React.createElement("option", { value: "ç”·" }, "ç”·"), React.createElement("option", { value: "å¥³" }, "å¥³")
                               )
                           ),
                           React.createElement("input", { className: "input-field", type: "email", placeholder: "Email (é¸å¡«)", value: regForm.email, onChange: e => setRegForm({...regForm, email: e.target.value}) }),
                           React.createElement("button", { onClick: handleRegister, className: "btn-primary w-full mt-4" }, "ç¢ºèªè¨»å†Š")
                       )
                   )
                )
            );
        }

        if (showHistory) return React.createElement("div", { className: "p-6 animate-fade-in pb-32" },
            React.createElement("button", { onClick: () => setShowHistory(null), className: "mb-4 text-xs font-bold text-gray-500 flex items-center gap-1" }, React.createElement(Icon, { name: "back", className: "w-4 h-4" }), "è¿”å›"),
            React.createElement("h3", { className: "font-black text-xl mb-4" }, showHistory === 'BOOKINGS' ? "æˆ‘çš„è¨‚ä½ç´€éŒ„" : "é»æ•¸ç´€éŒ„"),
            loadingHistory ? React.createElement("p", { className: "text-center text-gray-400" }, "è®€å–ä¸­...") :
            historyData.length === 0 ? React.createElement("p", { className: "text-center text-gray-400" }, "å°šç„¡ç´€éŒ„") :
            React.createElement("div", { className: "space-y-3" },
                historyData.map((item, i) => React.createElement("div", { key: i, className: "bg-white p-4 rounded-2xl border border-gray-100 shadow-sm" },
                    showHistory === 'BOOKINGS' ? 
                        React.createElement("div", null,
                            React.createElement("div", { className: "flex justify-between font-bold" }, React.createElement("span", null, item.é ç´„æ—¥æœŸ), React.createElement("span", null, item.é ç´„æ™‚é–“)),
                            React.createElement("p", { className: "text-xs text-gray-400 mt-1" }, `äººæ•¸: ${item.å¤§äºº}å¤§${item.å°å­©}å° | ä»£è™Ÿ: ${item.è¨‚ä½ä»£è™Ÿ}`)
                        ) :
                        React.createElement("div", { className: "flex justify-between items-center" },
                            React.createElement("div", null, React.createElement("p", { className: "font-bold text-sm" }, item.èªªæ˜), React.createElement("p", { className: "text-[10px] text-gray-400" }, new Date(item.æ™‚é–“).toLocaleDateString())),
                            React.createElement("span", { className: `font-black ${item.é»æ•¸è®ŠåŒ– > 0 ? 'text-green-600' : 'text-red-600'}` }, item.é»æ•¸è®ŠåŒ– > 0 ? `+${item.é»æ•¸è®ŠåŒ–}` : item.é»æ•¸è®ŠåŒ–)
                        )
                ))
            )
        );

        if (isEditing) return React.createElement("div", { className: "p-6 space-y-4 pt-20" },
             React.createElement("h3", { className: "font-black text-xl" }, "ä¿®æ”¹è³‡æ–™"),
             React.createElement("input", { className: "input-field", value: editForm.å§“å, onChange: e => setEditForm({...editForm, å§“å: e.target.value}) }),
             React.createElement("input", { className: "input-field", value: editForm.é›»è©±, onChange: e => setEditForm({...editForm, é›»è©±: e.target.value}) }),
             React.createElement("input", { className: "input-field", type: "date", value: editForm.ç”Ÿæ—¥?.split('T')[0], onChange: e => setEditForm({...editForm, ç”Ÿæ—¥: e.target.value}) }),
             React.createElement("select", { className: "input-field", value: editForm.æ€§åˆ¥, onChange: e => setEditForm({...editForm, æ€§åˆ¥: e.target.value}) },
                React.createElement("option", { value: "ç”·" }, "ç”·"), React.createElement("option", { value: "å¥³" }, "å¥³")
             ),
             React.createElement("input", { className: "input-field", type: "email", placeholder: "Email", value: editForm.Email, onChange: e => setEditForm({...editForm, Email: e.target.value}) }),
             React.createElement("div", { className: "flex gap-4" },
                 React.createElement("button", { className: "btn-secondary w-full", onClick: () => setIsEditing(false) }, "å–æ¶ˆ"),
                 React.createElement("button", { className: "btn-primary w-full", onClick: handleUpdate }, "å„²å­˜")
             )
        );

        return React.createElement("div", { className: "p-6 animate-fade-in pb-32" },
            React.createElement("div", { className: "bg-gradient-to-br from-slate-900 to-slate-800 p-8 rounded-[2.5rem] text-white shadow-2xl mb-8 relative overflow-hidden" },
               React.createElement("div", { className: "absolute top-0 right-0 w-32 h-32 bg-white/5 rounded-full blur-2xl -mr-10 -mt-10" }),
               React.createElement("p", { className: "text-[10px] font-black opacity-30 uppercase tracking-[0.3em] mb-8 relative z-10" }, RESTAURANT_NAME),
               React.createElement("div", { className: "flex justify-between items-end relative z-10" },
                React.createElement("div", null, React.createElement("h3", { className: "text-2xl font-black tracking-tight" }, data.member.å§“å), React.createElement("p", { className: "font-mono opacity-50 text-sm mt-1" }, data.member.é›»è©±)),
                React.createElement("div", { className: "text-right" }, React.createElement("p", { className: "text-[10px] opacity-40 font-black uppercase" }, "Points"), React.createElement("p", { className: "text-5xl font-black text-amber-400" }, data.member.é»æ•¸ || 0))
               )
            ),
            React.createElement("div", { className: "grid grid-cols-2 gap-4 mb-8" },
                React.createElement("button", { onClick: () => fetchHistory('BOOKINGS'), className: "bg-white p-5 rounded-3xl border border-gray-100 shadow-sm flex flex-col gap-3 active:scale-95 transition-all" },
                    React.createElement(Icon, { name: "calendar", className: "w-6 h-6 text-red-700" }), React.createElement("span", { className: "font-bold text-slate-700" }, "æˆ‘çš„è¨‚ä½")
                ),
                React.createElement("button", { onClick: () => fetchHistory('POINTS'), className: "bg-white p-5 rounded-3xl border border-gray-100 shadow-sm flex flex-col gap-3 active:scale-95 transition-all" },
                    React.createElement(Icon, { name: "gift", className: "w-6 h-6 text-amber-500" }), React.createElement("span", { className: "font-bold text-slate-700" }, "é»æ•¸ç´€éŒ„")
                )
            ),
            React.createElement("div", { className: "flex gap-2 mb-6 overflow-x-auto no-scrollbar" },
                React.createElement("button", { onClick: () => { setEditForm(data.member); setIsEditing(true); }, className: "px-4 py-2 bg-gray-100 rounded-full text-xs font-bold whitespace-nowrap" }, "ä¿®æ”¹è³‡æ–™"),
                React.createElement("button", { onClick: handleDelete, className: "px-4 py-2 bg-gray-100 rounded-full text-xs font-bold text-red-500 whitespace-nowrap" }, "åˆªé™¤å¸³è™Ÿ"),
                isAdmin && React.createElement("button", { onClick: () => setView('ADMIN'), className: "px-4 py-2 bg-slate-800 text-white rounded-full text-xs font-bold whitespace-nowrap shadow-lg shadow-slate-900/20" }, "ç®¡ç†å“¡å¾Œå°")
            ),
            React.createElement("div", { className: "space-y-4" },
                React.createElement("div", { className: "bg-white p-4 rounded-3xl border border-gray-100 shadow-sm flex justify-between items-center" },
                    React.createElement("div", { className: "flex items-center gap-3" },
                        React.createElement("div", { className: "w-10 h-10 bg-red-50 rounded-full flex items-center justify-center text-xl" }, "ğŸ‚"),
                        React.createElement("div", null, React.createElement("h4", { className: "font-black text-sm" }, "ç”Ÿæ—¥å„ªæƒ "), React.createElement("p", { className: "text-xs text-gray-400" }, "ç•¶æœˆå£½æ˜Ÿ 95 æŠ˜"))
                    ),
                    React.createElement("button", { onClick: () => Swal.fire('è«‹å‡ºç¤ºçµ¦åº—å“¡', 'æ ¸éŠ·ç¢¼: BDAY-' + new Date().getFullYear(), 'info'), className: "text-[10px] font-bold border border-gray-200 px-3 py-1 rounded-full" }, "åº—å“¡æ ¸éŠ·")
                )
            )
        );
    };

    const InfoView = ({ data }) => React.createElement("div", { className: "p-6 space-y-6 animate-fade-in pb-32" },
         React.createElement("div", { className: "bg-white p-6 rounded-3xl border border-gray-100 shadow-sm" }, 
             React.createElement("h3", { className: "font-black text-xl mb-4" }, "åº—å®¶è³‡è¨Š"), 
             React.createElement("div", { className: "space-y-4" },
                 React.createElement("div", { className: "flex items-start gap-4" },
                    React.createElement("div", { className: "w-10 h-10 rounded-full bg-red-50 flex items-center justify-center flex-shrink-0" }, React.createElement(Icon, { name: "phone", className: "w-5 h-5 text-red-700" })),
                    React.createElement("div", null,
                        React.createElement("p", { className: "text-xs font-bold text-gray-400 mb-1" }, "é ç´„å°ˆç·š"),
                        React.createElement("a", { href: "tel:082332530", className: "text-lg font-black text-slate-800 underline decoration-red-200 decoration-2 underline-offset-2" }, "082-332530")
                    )
                 ),
                 React.createElement("div", { className: "flex items-start gap-4" },
                    React.createElement("div", { className: "w-10 h-10 rounded-full bg-red-50 flex items-center justify-center flex-shrink-0" }, React.createElement(Icon, { name: "home", className: "w-5 h-5 text-red-700" })),
                    React.createElement("div", null,
                        React.createElement("p", { className: "text-xs font-bold text-gray-400 mb-1" }, "é¤å»³åœ°å€"),
                        React.createElement("p", { className: "text-sm font-bold text-slate-800 leading-relaxed" }, "é‡‘é–€ç¸£é‡‘æ¹–é®å¤ªæ¹–è·¯äºŒæ®µ3å··6è™Ÿ")
                    )
                 ),
                 React.createElement("div", { className: "pt-4 border-t border-gray-50" },
                    React.createElement("p", { className: "text-xs font-bold mb-2 flex items-center gap-2" }, React.createElement(Icon, { name: "calendar", className: "w-4 h-4 text-gray-400" }), "ç‡Ÿæ¥­æ™‚é–“"),
                    React.createElement("div", { className: "bg-gray-50 p-4 rounded-2xl space-y-2" },
                        React.createElement("div", { className: "flex justify-between text-xs" }, React.createElement("span", { className: "font-bold" }, "åˆé¤"), React.createElement("span", { className: "text-gray-600" }, "11:00 - 14:30 (æœ€å¾Œé»é¤ 13:30)")),
                        React.createElement("div", { className: "flex justify-between text-xs" }, React.createElement("span", { className: "font-bold" }, "æ™šé¤"), React.createElement("span", { className: "text-gray-600" }, "17:00 - 20:30 (æœ€å¾Œé»é¤ 19:30)")),
                        React.createElement("div", { className: "flex justify-between text-xs pt-2 border-t border-gray-200 mt-2" }, React.createElement("span", { className: "font-black text-red-600" }, "å…¬ä¼‘æ—¥"), React.createElement("span", { className: "font-bold text-red-600" }, "æ¯é€±ä¸€"))
                    )
                 )
             )
         ),
         React.createElement("div", { className: "rounded-3xl overflow-hidden shadow-lg border-4 border-white h-64 bg-gray-100" },
            React.createElement("iframe", { 
                src: "https://maps.google.com/maps?q=é‡‘é–€ç¸£é‡‘æ¹–é®å¤ªæ¹–è·¯äºŒæ®µ3å··6è™Ÿ&t=&z=16&ie=UTF8&iwloc=&output=embed", 
                width: "100%", height: "100%", style: {border:0}, allowFullScreen: "", loading: "lazy" 
            })
         )
    );

    const FaqView = ({ data }) => React.createElement("div", { className: "p-6 space-y-6 animate-fade-in pb-32" },
         React.createElement("div", { className: "bg-white rounded-3xl overflow-hidden shadow-sm border border-gray-100 mb-4" },
             React.createElement("img", { src: "https://i.ibb.co/WpMct0Ls/Gemini-Generated-Image-fjx6tvfjx6tvfjx6-1.png", className: "w-full object-cover" })
         ),
         React.createElement("div", { className: "bg-white p-6 rounded-3xl border border-gray-100 shadow-sm" },
            React.createElement("h3", { className: "font-black text-lg mb-4 flex items-center gap-2" }, React.createElement(Icon, { name: "question", className: "w-5 h-5 text-amber-500" }), "å¸¸è¦‹å•é¡Œ"),
            (data.faqs || []).map((f, i) => React.createElement("details", { key: i, className: "mb-3 border-b border-gray-50 pb-3 group" }, 
                React.createElement("summary", { className: "text-sm font-bold cursor-pointer text-slate-700 list-none flex items-center justify-between" }, 
                    f.å•é¡Œ, 
                    React.createElement("span", { className: "text-gray-300 group-open:rotate-180 transition-transform" }, "â–¼")
                ), 
                React.createElement("p", { className: "text-xs text-gray-500 mt-3 leading-relaxed bg-gray-50 p-3 rounded-xl" }, f.å›ç­”)
            ))
         )
    );

    const AdminView = ({ profile, setView }) => {
        const [bookings, setBookings] = useState([]);
        const [loading, setLoading] = useState(true);
        const [posModal, setPosModal] = useState(null);

        useEffect(() => {
            const fetchAdmin = async () => {
                const res = await runGAS('getAdminData', { lineUserId: profile.userId });
                if (res.status === 'success') {
                    setBookings(res.bookings);
                } else {
                    Swal.fire('æ¬Šé™éŒ¯èª¤', 'æ‚¨ä¸æ˜¯ç®¡ç†å“¡', 'error').then(() => setView('HOME'));
                }
                setLoading(false);
            };
            fetchAdmin();
        }, []);

        const showPosModal = (b) => {
            // Format for POS: Simple plain text
            const orderText = 
`ã€${b.è¨‚ä½ä»£è™Ÿ}ã€‘
æ—¥æœŸ: ${b.é ç´„æ—¥æœŸ}
æ™‚é–“: ${b.é ç´„æ™‚é–“}
äººæ•¸: ${b.å¤§äºº}å¤§ ${b.å°å­©}å°
å§“å: ${b.å§“å}
é›»è©±: ${b.é›»è©±}
å‚™è¨»: ${b.å‚™è¨»} ${b.ç´ é£Ÿ==='æ˜¯'?'(ç´ )':''}

---------- é»é¤æ˜ç´° ----------
${b.é é»é¤ ? b.é é»é¤.split('; ').join('\n') : 'ç„¡é é»é¤'}
----------------------------`;
            setPosModal(orderText);
        };

        if (loading) return React.createElement("div", { className: "p-10 text-center" }, "è¼‰å…¥ç®¡ç†è³‡æ–™...");

        return React.createElement("div", { className: "p-6 pb-32 animate-fade-in" },
            React.createElement("div", { className: "flex justify-between items-center mb-6" },
                 React.createElement("h3", { className: "font-black text-2xl" }, "ç®¡ç†å“¡å¾Œå°"),
                 React.createElement("button", { onClick: () => setView('MEMBER'), className: "text-xs font-bold text-gray-500" }, "è¿”å›å‰å°")
            ),
            
            // Stats
            React.createElement("div", { className: "grid grid-cols-2 gap-4 mb-6" },
                React.createElement("div", { className: "bg-slate-800 text-white p-4 rounded-2xl" },
                    React.createElement("p", { className: "text-xs opacity-60" }, "ä»Šæ—¥è¨‚ä½æ•¸"),
                    React.createElement("p", { className: "text-3xl font-black" }, bookings.filter(b => b.é ç´„æ—¥æœŸ === new Date().toISOString().split('T')[0]).length)
                ),
                React.createElement("div", { className: "bg-white border p-4 rounded-2xl" },
                    React.createElement("p", { className: "text-xs text-gray-400" }, "å¾…ç¢ºèª"),
                    React.createElement("p", { className: "text-3xl font-black text-amber-500" }, bookings.length)
                )
            ),

            // List
            React.createElement("div", { className: "space-y-4" },
                bookings.map((b, i) => React.createElement("div", { key: i, className: "bg-white p-5 rounded-3xl border border-gray-100 shadow-sm" },
                    React.createElement("div", { className: "flex justify-between items-start mb-3" },
                        React.createElement("div", null,
                            React.createElement("span", { className: "bg-red-100 text-red-700 text-[10px] font-bold px-2 py-1 rounded-md mb-2 inline-block" }, b.è¨‚ä½ä»£è™Ÿ),
                            React.createElement("h4", { className: "font-black text-lg" }, b.å§“å),
                            React.createElement("p", { className: "text-xs text-gray-500" }, b.é›»è©±)
                        ),
                        React.createElement("div", { className: "text-right" },
                             React.createElement("p", { className: "font-bold text-lg" }, b.é ç´„æ™‚é–“),
                             React.createElement("p", { className: "text-xs text-gray-400" }, b.é ç´„æ—¥æœŸ)
                        )
                    ),
                    React.createElement("div", { className: "bg-gray-50 p-3 rounded-xl text-xs text-gray-600 mb-3" },
                         React.createElement("p", null, `äººæ•¸: ${b.å¤§äºº}å¤§ ${b.å°å­©}å° / æ¤…: ${b.å…’ç«¥æ¤…}`),
                         b.å‚™è¨» && React.createElement("p", { className: "mt-1 text-red-500" }, `å‚™è¨»: ${b.å‚™è¨»}`),
                         b.é é»é¤ && React.createElement("div", { className: "mt-2 pt-2 border-t border-gray-200" },
                             React.createElement("p", { className: "font-bold mb-1" }, "é é»é¤é»:"),
                             b.é é»é¤.split('; ').map((item, idx) => React.createElement("p", { key: idx, className: "pl-2" }, `â€¢ ${item}`))
                         )
                    ),
                    React.createElement("div", { className: "flex gap-2" },
                        React.createElement("a", { href: `tel:${b.é›»è©±}`, className: "flex-1 py-2 text-center border border-gray-200 rounded-xl text-xs font-bold" }, "æ’¥æ‰“é›»è©±"),
                        React.createElement("button", { onClick: () => showPosModal(b), className: "flex-1 py-2 text-center bg-slate-800 text-white rounded-xl text-xs font-bold flex items-center justify-center gap-1" },
                            React.createElement(Icon, { name: "printer", className: "w-3 h-3" }), "POS å–®"
                        )
                    )
                ))
            ),

            // POS Modal
            posModal && React.createElement("div", { className: "fixed inset-0 z-[100] bg-black/80 flex items-center justify-center p-4", onClick: () => setPosModal(null) },
                React.createElement("div", { className: "bg-white w-full max-w-sm rounded-lg overflow-hidden", onClick: e => e.stopPropagation() },
                    React.createElement("div", { className: "p-4 bg-slate-800 text-white flex justify-between items-center" },
                        React.createElement("h3", { className: "font-bold" }, "POS è¼¸å…¥æ¨¡å¼"),
                        React.createElement("button", { onClick: () => setPosModal(null) }, React.createElement(Icon, { name: "x", className: "w-5 h-5" }))
                    ),
                    React.createElement("div", { className: "p-4 bg-yellow-50 overflow-y-auto max-h-[60vh]" },
                        React.createElement("pre", { className: "pos-receipt whitespace-pre-wrap text-sm" }, posModal)
                    ),
                    React.createElement("div", { className: "p-4 border-t text-center text-xs text-gray-500" }, "è«‹ä¾ç…§ä¸Šæ–¹è³‡è¨Šè¼¸å…¥è‡³ POS æ©Ÿå°")
                )
            )
        );
    };

    const App = () => {
      const [view, setView] = useState('HOME');
      const [data, setData] = useState({});
      const [profile, setProfile] = useState(null);
      const [cart, setCart] = useState([]);
      const [pendingBooking, setPendingBooking] = useState(null); // æš«å­˜è¨‚ä½è³‡æ–™

      useEffect(() => {
        const init = async () => {
          try {
            if (window.liff) {
              await window.liff.init({ liffId: LIFF_ID });
              if (window.liff.isLoggedIn()) {
                const p = await window.liff.getProfile();
                setProfile(p);
                const res = await runGAS('getInitialData', { lineUserId: p.userId });
                if (res.status === 'success') setData(res);
              } else { window.liff.login(); }
            }
          } catch (e) { console.error(e); }
          finally { 
             setTimeout(() => {
                const ol = document.getElementById('loading-overlay');
                if(ol) { ol.style.opacity='0'; setTimeout(()=>ol.style.display='none',600); }
             }, 1000);
          }
        };
        init();
      }, []);

      const addToCart = (item) => setCart([...cart, item]);
      const clearCart = () => setCart([]);
      
      const handlePreorderSubmit = async () => {
          if (!pendingBooking) return;
          setView('BOOKING');
      };

      const renderView = () => {
        if(view === 'ADMIN') return React.createElement(AdminView, { profile, setView }); 
        switch(view) {
          case 'BOOKING': return React.createElement(BookingView, { profile, data, onComplete: ()=>setView('HOME'), cart, onClearCart: clearCart, setView, setPendingBooking, pendingBooking });
          case 'MENU': return React.createElement(MenuView, { menu: data.restaurantMenu||[], addToCart, cart, setView, onSubmitPreorder: pendingBooking ? handlePreorderSubmit : null });
          case 'INFO': return React.createElement(InfoView, { data });
          case 'FAQ': return React.createElement(FaqView, { data });
          case 'MEMBER': return React.createElement(MemberView, { data, profile, setView });
          default: return React.createElement(HomeView, { data, setView });
        }
      };

      return React.createElement("div", { className: "max-w-md mx-auto min-h-screen bg-white relative shadow-2xl" },
        React.createElement("div", { className: "bg-white/90 backdrop-blur-md p-6 sticky top-0 z-30 flex justify-between items-center border-b border-gray-50" },
           React.createElement("div", null, React.createElement("h1", { className: "font-black text-slate-900 text-xl tracking-tighter" }, RESTAURANT_NAME), React.createElement("p", { className: "text-[9px] text-gray-400 font-black uppercase tracking-widest" }, profile?.displayName || "GUEST")),
           profile && React.createElement("img", { src: profile.pictureUrl, className: "w-10 h-10 rounded-xl shadow-md border-2 border-white" })
        ),
        renderView(),
        React.createElement("div", { className: "fixed bottom-6 inset-x-6 h-20 glass border border-white/50 rounded-full shadow-2xl shadow-slate-300/50 flex items-center justify-around px-2 z-50" },
          [
            { id: 'HOME', icon: 'home', label: 'é¦–é ' },
            { id: 'MENU', icon: 'menu', label: 'èœå–®' },
            { id: 'BOOKING', icon: 'calendar', label: 'è¨‚ä½' },
            { id: 'INFO', icon: 'info', label: 'è³‡è¨Š' },
            { id: 'MEMBER', icon: 'user', label: 'æœƒå“¡' }
          ].map(item => React.createElement("button", {
            key: item.id, onClick: () => setView(item.id),
            className: `flex flex-col items-center justify-center w-14 h-14 rounded-2xl transition-all ${view === item.id ? 'bg-red-50 text-red-700 -translate-y-2 shadow-lg shadow-red-100' : 'text-gray-300 hover:text-gray-400'}`
          },
            React.createElement("div", { className: "relative" },
               React.createElement(Icon, { name: item.icon, className: "w-6 h-6" }),
               item.id === 'MENU' && cart.length > 0 && React.createElement("span", { className: "absolute -top-1 -right-1 w-2.5 h-2.5 bg-red-600 rounded-full border-2 border-white" })
            ),
            view === item.id && React.createElement("span", { className: "text-[9px] font-black mt-1" }, item.label)
          ))
        )
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(React.createElement(App));
  </script>
</body>
</html>